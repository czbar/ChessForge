<Window x:Name="ChessForgeMain" x:Class="ChessForge.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:p="clr-namespace:ChessForge.Properties"
        xmlns:local="clr-namespace:ChessForge"
        xmlns:uc="clr-namespace:ChessForge"
        mc:Ignorable="d"
        Title="Chess Forge" Height="900" Width="1676" Loaded="Window_Loaded" MouseDown="OnMouseDown" MouseUp="OnMouseUp" MouseMove="OnMouseMove" Closing="ChessForgeMain_Closing" 
        PreviewKeyDown="MainWindow_PreviewKeyDown"
        PreviewKeyUp="MainWindow_PreviewKeyUp"         
        MouseEnter="ChessForgeMain_MouseEnter" >

    <Window.Resources>
        <ContextMenu x:Name="UiCmIndexExpandCollapse" x:Key="CmIndexExpandCollapse">
            <MenuItem x:Name="UiMnciExpand" Header="{x:Static p:Resources.CmExpand}" Click="UiMnciExpand_Click"/>
            <MenuItem x:Name="UiMnciCollapse" Header="{x:Static p:Resources.CmCollapse}" Click="UiMnciCollapse_Click"/>
            <Separator />
            <MenuItem x:Name="UiMnciExpandAll" Header="{x:Static p:Resources.CmExpandAll}" Click="UiMnciExpandAll_Click"/>
            <MenuItem x:Name="UiMnciCollapseAll" Header="{x:Static p:Resources.CmCollapseAll}" Click="UiMnciCollapseAll_Click"/>
            <Separator />
            <MenuItem x:Name="UiMnciExpandThisOne" Header="{x:Static p:Resources.CmExpandThisOnly}" Click="UiMnciExpandThisOne_Click"/>
        </ContextMenu>

        <ContextMenu x:Name="UiCmReferences" x:Key="CmReferences">
            <MenuItem x:Name="UiMnciRemoveReference" Header="{x:Static p:Resources.RemoveReference}" Click="UiMnciRemoveReference_Click" />
            <Separator />
            <MenuItem x:Name="UiMnciAutoPlaceReference" Header="{x:Static p:Resources.AutoPlaceReference}" Click="UiMnciAutoPlaceReference_Click" />
            <MenuItem x:Name="UiMnciAutoPlaceMoveReferences" Header="{x:Static p:Resources.AutoPlaceMoveReferences}" Click="UiMnciAutoPlaceMoveReferences_Click" />
            <MenuItem x:Name="UiMnciAutoPlaceAllReferences" Header="{x:Static p:Resources.AutoPlaceAllReferences}" Click="UiMnciAutoPlaceAllReferences_Click" />
        </ContextMenu>

        <Style  x:Key="RoundedBorder" TargetType="Label">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Label}">
                        <Border BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                Background="{TemplateBinding Background}" 
                                Padding="{TemplateBinding Padding}" 
                                SnapsToDevicePixels="true" 
                                CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                              RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Window.CommandBindings>
        <CommandBinding Command="local:CustomCommands.FlipBoard" Executed="UiMnFlipBoard_Click"/>
        <CommandBinding Command="local:CustomCommands.SaveWorkbook" Executed="CustomCommand_SaveWorkbook"/>
        <CommandBinding Command="ApplicationCommands.Undo" Executed="UiMnUndo_Click"/>
    </Window.CommandBindings>
    <Window.InputBindings>
        <KeyBinding Key="F" Modifiers="Control" Command="local:CustomCommands.FlipBoard"/>
        <KeyBinding Key="S" Modifiers="Control" Command="local:CustomCommands.SaveWorkbook"/>
        <KeyBinding Key="Z" Modifiers="Control" Command="ApplicationCommands.Undo"/>
    </Window.InputBindings>

    <Grid x:Name="_gridUber" ShowGridLines="False">
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition Height="900*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width= "*" />
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Row="0" Background="LightGray" >
            <Grid x:Name="_gridMenu" ShowGridLines="False" VerticalAlignment="Top"  >
                <Grid.RowDefinitions>
                    <RowDefinition Height="30" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="450" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Menu x:Name = "UiMainMenu" VerticalAlignment="Center" Margin="0,0,0,0" Background="LightGray" BorderBrush="#993C3C3C" Grid.ColumnSpan="3" Height="20">
                    <!-- Game menu -->
                    <MenuItem x:Name ="MenuFile"  Header="{x:Static p:Resources.File}" Margin="0,0,0,0" >
                        <MenuItem x:Name="UiMnNewWorkbook" Header="{x:Static p:Resources.NewWorkbook}" Click="UiMnNewWorkbook_Click" />
                        <MenuItem x:Name="UiMnOpenWorkbook" Header="{x:Static p:Resources.OpenWorkbook}" Click="UiMnOpenWorkbook_Click"/>
                        <MenuItem x:Name="UiMnCloseWorkbook" Header="{x:Static p:Resources.CloseWorkbook}" Click="UiMnCloseWorkbook_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnOnlineLibrary" Header="{x:Static p:Resources.OnlineLibrary}"  Click="UiMnOnlineLibrary_Click" />
                        <MenuItem x:Name="UiMnOnlineLibraryPrivate" Header="{x:Static p:Resources.OnlineLibraryPrivate}"  Click="UiMnOnlineLibraryPrivate_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnWorkbookSave" Header="{x:Static p:Resources.Save}" Click="UiMnWorkbookSave_Click" InputGestureText="Ctrl+S" />
                        <MenuItem x:Name="UiMnWorkbookSaveAs" Header="{x:Static p:Resources.SaveAs}" Click="UiMnWorkbookSaveAs_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnExportRtf" Header="{x:Static p:Resources.ExportRtf}" Click="UiMnWriteRtf_Click" />
                        <MenuItem x:Name="UiMnExportText" Header="{x:Static p:Resources.ExportText}" Click="UiMnWriteText_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnBackupVersion" Header="{x:Static p:Resources.BackUpThisVersion}" Click="UiMnBackupVersion_Click" />
                        <Separator />
                    </MenuItem>
                    <MenuItem Header="{x:Static p:Resources.Training}" Margin="0,0,0,0">
                        <MenuItem x:Name="UiMnStartTraining"  Header="{x:Static p:Resources.StartNewSession}"  Click="UiMnStartTrainingHere_Click" InputGestureText="T" />
                        <MenuItem x:Name="UiMnRestartTraining"  Header="{x:Static p:Resources.RestartTrainingSession}" Click="UiMnTrainRestartTraining_Click"/>
                        <MenuItem x:Name="UiMnExitTraining" Header="{x:Static p:Resources.ExitTraining}" Click="UiMnStopTraining_Click"/>
                        <Separator />
                        <MenuItem x:Name="UiMnMainPlayEngine" Header="{x:Static p:Resources.PlayAgainstComputer}"  Click="UiMnPlayEngine_Click" />
                    </MenuItem>
                    <MenuItem Header="{x:Static p:Resources.Edit}" Margin="0,0,0,0">
                        <MenuItem x:Name="UiMnFindGames" Header="{x:Static p:Resources.FindGames}" Click="UiMnFindGames_Click" InputGestureText="Ctrl+G" />
                        <MenuItem x:Name="UiMnFindPositions" Header="{x:Static p:Resources.SearchByFen}"  Click="UiMnFindPositions_Click" InputGestureText="Shift+F3" />
                        <MenuItem x:Name="UiMnFindIdentical" Header="{x:Static p:Resources.FindIdenticalPosition}"  Click="UiMnFindIdenticalPosition_Click" InputGestureText="F3" />
                        <Separator />
                        <MenuItem x:Name="UiMnAnnotations" Header="{x:Static p:Resources.Annotations}" Click="UiMnAnnotationsDialog_Click" />
                        <MenuItem x:Name="UiMnCommentBeforeMove" Header="{x:Static p:Resources.CommentBeforeMove}" Click="UiMnCommentBeforeMoveDialog_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnMainCopy" Header="{x:Static p:Resources.Copy}"  InputGestureText="Ctrl+C" Click="UiMnMainCopy_Click" />
                        <MenuItem x:Name="UiMnMainCut" Header="{x:Static p:Resources.Cut}"  InputGestureText="Ctrl+X" Click="UiMnMainCut_Click" />
                        <MenuItem x:Name="UiMnMainPaste" Header="{x:Static p:Resources.Paste}"  InputGestureText="Ctrl+V" Click="UiMnPaste_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnStSelectHighlighted" Header="{x:Static p:Resources.CopyHighlightedLine}"  InputGestureText="Ctrl+L" Click="UiMnSelectHighlighted_Click" />
                        <MenuItem x:Name="UiMnStSelectSubtree" Header="{x:Static p:Resources.CopySubtree}" InputGestureText="Ctrl+A" Click="UiMnSelectSubtree_Click" />
                        <MenuItem x:Name="UiMnCopyFen" Header="{x:Static p:Resources.CopyFENtoClipboard}" Click="UiMnCopyFen_Click" InputGestureText="Ctrl+E" />
                        <Separator />
                        <MenuItem x:Name="UiMnUndo" Header="{x:Static p:Resources.Undo}" Click="UiMnUndo_Click" InputGestureText="Ctrl+Z" />
                    </MenuItem>
                    <MenuItem Header="{x:Static p:Resources.View}" Margin="0,0,0,0">
                        <MenuItem Header="{x:Static p:Resources.FlipBoard}" Click="UiMnFlipBoard_Click" InputGestureText="Ctrl+F" >
                            <MenuItem.Icon>
                                <Image Source="Resources/Images/flip_board.png"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem x:Name="UiMnChessboards" Header="{x:Static p:Resources.Chessboards}" Click="UiMnChessboards_Click" />
                        <Separator />
                        <MenuItem Header="{x:Static p:Resources.ApplicationOptions}" Click="UiMnApplicationOptions_Click" />
                        <MenuItem Header="{x:Static p:Resources.EngineOptions}" Click="UiMnEngineOptions_Click" />
                        <MenuItem x:Name="UiMnWorkbookOptions" Header="{x:Static p:Resources.WorkbookOptions}" Click="UiMnWorkbookOptions_Click" />
                        <MenuItem Header="{x:Static p:Resources.BlunderDetectionOptions}" Click="UiMnBlunderDetectionOptions_Click" />
                        <MenuItem Header="{x:Static p:Resources.AnalysisEngine}" Click="UiMnSelectEngine_Click" />
                        <MenuItem Header="{x:Static p:Resources.DlgOnlineLibraries}" Click="UiMnOnlineLibraries_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnDarkMode"  Header="{x:Static p:Resources.DarkMode}" IsCheckable="True" Checked="UiMnDarkMode_Checked" Unchecked="UiMnDarkMode_Unchecked"   />
                        <Separator />
                        <MenuItem x:Name="UiMnIncreaseFontSize" Header="{x:Static p:Resources.IncreaseFontSize}" Click="UiBtnFontSizeUp_Click" >
                            <MenuItem.Icon>
                                <Image Source="Resources/Images/FontSizeUp.png"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem x:Name="UiMnDecreaseFontSize" Header="{x:Static p:Resources.DecreaseFontSize}" Click="UiBtnFontSizeDown_Click">
                            <MenuItem.Icon>
                                <Image Source="Resources/Images/FontSizeDown.png"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem x:Name="UiMnFixVariableFontSize" Header="" Click="UiMnFixVariableFont_Click">
                            <MenuItem.Icon>
                                <Image Source="Resources/Images/FontSizeFixed.png"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem  x:Name="UiMnFontDefaults" Header="{x:Static p:Resources.RestoreFontDefaults}" Click="UiMnFontDefaults_Click" />
                    </MenuItem>
                    <MenuItem Header="{x:Static p:Resources.Chapter}" Margin="0,0,0,0">
                        <MenuItem x:Name="UiMnEvaluateGames" Header="{x:Static p:Resources.MnEvaluateGames}" Click="UiMnEvaluateGames_Click" />
                        <MenuItem x:Name="UiMnAssignECO" Header="{x:Static p:Resources.AssignECO}" Click="UiAssignEco_Click" />
                        <MenuItem x:Name="UiMnOrderGames" Header="{x:Static p:Resources.GamesOrder}" Click="UiMnSortGames_Click" />
                        <MenuItem x:Name="UiMnSetThumbnails" Header="{x:Static p:Resources.GameThumbnails}" Click="UiMnSetThumbnails_Click" />
                        <MenuItem x:Name="UiMnExerciseViewConfig" Header="{x:Static p:Resources.ShowSolutions}" IsCheckable="True" IsChecked="False" Click="UiMnExerciseViewConfig_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnSaveDiagrams" Header="{x:Static p:Resources.SaveDiagramsAsImages}" Click="UiMn_SaveDiagrams_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnSplitChapter" Header="{x:Static p:Resources.SplitChapterMenu}"  Click="UiMnSplitChapter_Click" />
                        <MenuItem x:Name="UiMnMergeChapters" Header="{x:Static p:Resources.MergeChapters}" Click="UiMnMergeChapters_Click" />
                    </MenuItem>
                    <MenuItem Header="{x:Static p:Resources.Tools}" Margin="0,0,0,0">
                        <MenuItem x:Name="UiMnMainImportFromPgn" Header="{x:Static p:Resources.ImportFromPgn}" Click="UiMnMainImportFromPgn_Click"  />
                        <MenuItem x:Name="UiMnDownloadWebGames" Header="{x:Static p:Resources.DownloadGamesFromWeb}" Click="UiMnDownloadWebGames_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnCopyArticles" Header="{x:Static p:Resources.CopyArticlesToChapter}" Click="UiMnCopyArticles_Click" />
                        <MenuItem x:Name="UiMnMoveArticles" Header="{x:Static p:Resources.MoveArticlesToChapter}" Click="UiMnMoveArticles_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnPasteEngineLines" Header="{x:Static p:Resources.PasteEngineLines}" Click="UiMnPasteEngineLines_Click"  />
                        <MenuItem x:Name="UiMnCleanLinesAndComments" Header="{x:Static p:Resources.MenuDeleteNotes}" Click="UiCleanLinesAndComments_Click" />
                        <Separator />
                        <MenuItem x:Name="UiMnMainDeleteGames" Header="{x:Static p:Resources.DeleteGames}" Click="UiMnToolsDeleteGames_Click" />
                        <MenuItem x:Name="UiMnMainDeleteExercises" Header="{x:Static p:Resources.DeleteExercises}" Click="UiMnToolsDeleteExercises_Click"  />
                        <MenuItem x:Name="UiMnRemoveDuplicates" Header="{x:Static p:Resources.RemoveDuplicates}" Click="UiMnRemoveDuplicates_Click"  />
                    </MenuItem>
                    <MenuItem Header="{x:Static p:Resources.Help}" Margin="0,0,0,0">
                        <MenuItem Header="{x:Static p:Resources.Wiki}" Click="UiMnHelpWiki_Click" />
                        <!--<MenuItem Header="{x:Static p:Resources.CheckForUpdates}" Click="UiMnCheckForUpdates_Click" />-->
                        <Separator />
                        <MenuItem Header="{x:Static p:Resources.About}" Click="UiMnHelpAbout_Click" />
                    </MenuItem>
                </Menu>
                <Grid  x:Name="UiBackForwardArrows" Grid.Column="2" HorizontalAlignment="Right" VerticalAlignment="Top" Visibility="Visible">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Image x:Name="UiImgNavigateBack" Grid.Column="0" ToolTip="{x:Static p:Resources.GoBack}" VerticalAlignment="Center" Margin="0,5,50,0"  HorizontalAlignment="Right" Height="20" Width="24" Source="Resources/Images/arrow-left.png" Visibility="Visible" MouseDown="UiImgNavigateBack_MouseDown" />
                    <Image x:Name="UiImgNavigateForward" Grid.Column="0" ToolTip="{x:Static p:Resources.GoForward}" VerticalAlignment="Center" Margin="0,5,20,0"  HorizontalAlignment="Right" Height="20" Width="24" Source="Resources/Images/arrow-right.png" Visibility="Visible" MouseDown="UiImgNavigateForward_MouseDown" />
                </Grid>
                <Grid x:Name="UiGridToggles" Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Visible" >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto "/>
                        <ColumnDefinition Width="Auto "/>
                        <ColumnDefinition Width="Auto "/>
                        <ColumnDefinition Width="Auto "/>
                        <ColumnDefinition Width="Auto "/>
                        <ColumnDefinition Width="Auto "/>
                        <ColumnDefinition Width="Auto "/>
                        <ColumnDefinition Width="Auto "/>
                        <ColumnDefinition Width="Auto "/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Label x:Name="UiLblAutoSave" Grid.Column="0"  Content="{x:Static p:Resources.AutoSave}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,2,0,0" Height="28"   />
                    <Image x:Name="UiImgAutoSaveOn"  Grid.Column="1" ToolTip="{x:Static p:Resources.TurnAutoSaveOff}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0"  Height="40" Width="40" Source="Resources/Images/ToggleOn.png" Visibility="Hidden" MouseDown="UiImgAutoSaveOn_MouseDown" />
                    <Image x:Name="UiImgAutoSaveOff" Grid.Column="1" ToolTip="{x:Static p:Resources.TurnAutoSaveOn}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0"  Height="40" Width="40" Source="Resources/Images/ToggleOff.png" MouseDown="UiImgAutoSaveOff_MouseDown" />
                    <Button Name="UiBtnFontSizeUp" BorderThickness="0"  Grid.Column="2" Width="30" Height="22"  HorizontalAlignment="Left" Margin="35,0,0,0" ToolTip="{x:Static p:Resources.IncreaseFontSize}" Click="UiBtnFontSizeUp_Click">
                        <Image Source="Resources/Images/FontSizeUp.png" Width="18" Height="18"></Image>
                    </Button>
                    <Button Name="UiBtnFontSizeDown" BorderThickness="0" Grid.Column="2" Width="30" Height="22"  HorizontalAlignment="Left" Margin="70,0,0,0" ToolTip="{x:Static p:Resources.DecreaseFontSize}" Click="UiBtnFontSizeDown_Click">
                        <Image Source="Resources/Images/FontSizeDown.png" Width="18" Height="18"></Image>
                    </Button>
                    <Button Name="UiBtnFontSizeFixed" BorderThickness="0" Grid.Column="2" Width="30" Height="22"  HorizontalAlignment="Left" Margin="105,0,0,0" ToolTip="{x:Static p:Resources.UseFixedFontSize}" Click="UiBtnFontSizeFixed_Click" >
                        <Image Source="Resources/Images/FontSizeFixed.png" Width="18" Height="18"></Image>
                    </Button>
                    <Button Name="UiBtnFontSizeVariable" BorderThickness="0" Grid.Column="2" Width="30" Height="22"  HorizontalAlignment="Left" Margin="105,0,0,0" ToolTip="{x:Static p:Resources.UseVariableFontSize}" Visibility="Hidden" Click="UiBtnFontSizeVariable_Click">
                        <Image Source="Resources/Images/FontSizeVariable.png" Width="18" Height="18"></Image>
                    </Button>
                    <Label x:Name="UiLblExplorers" Grid.Column="3"  Content="{x:Static p:Resources.Explorers}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="30,2,0,0" Height="28"  />
                    <Image x:Name="UiImgExplorersOn" Grid.Column="4" ToolTip="{x:Static p:Resources.TurnExplorersOff}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0"  Height="40" Width="40" Source="Resources/Images/ToggleOn.png" Visibility="Collapsed" PreviewMouseDown="ExplorersToggleOn_PreviewMouseDown" />
                    <Image x:Name="UiImgExplorersOff" Grid.Column="4" ToolTip="{x:Static p:Resources.TurnExplorersOn}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0"  Height="40" Width="40" Source="Resources/Images/ToggleOff.png" Visibility="Visible" PreviewMouseDown="ExplorersToggleOff_PreviewMouseDown" />
                    <Label x:Name="UiLblEngine" Grid.Column="5"  Content="{x:Static p:Resources.Engine}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="30,2,0,0" Height="28"   />
                    <Image x:Name="UiImgEngineOn" Cursor="Hand" ToolTip="{x:Static p:Resources.TurnEngineOff}" Grid.Column="6" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0"  Height="22" Width="40" Source="Resources/Images/ToggleOn.png" Visibility="Collapsed" PreviewMouseLeftButtonDown="EngineToggleOn_OnPreviewMouseLeftButtonDown" />
                    <Image x:Name="UiImgEngineOnGray" Cursor="Hand" ToolTip="{x:Static p:Resources.TtAllowEvalUpdate}" Grid.Column="6" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0"  Height="22" Width="40" Source="Resources/Images/ToggleOnGray.png" Visibility="Collapsed" PreviewMouseLeftButtonDown="EngineToggleGray_OnPreviewMouseLeftButtonDown" />
                    <Image x:Name="UiImgEngineOff" Cursor="Hand" ToolTip="{x:Static p:Resources.TurnEngineOn}" Grid.Column="6" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0"  Height="22" Width="40" Source="Resources/Images/ToggleOff.png" Visibility="Visible"  PreviewMouseLeftButtonDown="EngineToggleOff_OnPreviewMouseLeftButtonDown" />
                    <Label x:Name="UiLblChart" Grid.Column="7"  Content="{x:Static p:Resources.Chart}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="30,2,0,0" Height="28"   />
                    <Image x:Name="UiImgChartOn" Cursor="Hand" ToolTip="{x:Static p:Resources.HideEvaluationChart}" Grid.Column="8" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0"  Height="22" Width="40" Source="Resources/Images/ToggleOn.png" Visibility="Collapsed" PreviewMouseLeftButtonDown="EvaluationChartToggleOn" />
                    <Image x:Name="UiImgChartOff" Cursor="Hand" ToolTip="{x:Static p:Resources.ShowEvaluationChart}" Grid.Column="8" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="10,0,0,0"  Height="22" Width="40" Source="Resources/Images/ToggleOff.png" Visibility="Visible" PreviewMouseLeftButtonDown="EvaluationChartToggleOff" />
                    <ProgressBar x:Name="UiPbEngineThinking" Visibility="Visible" Grid.Column="9" HorizontalAlignment="Left" Height="5" Margin="20,0,0,0" VerticalAlignment="Center" Width="100"/>
                </Grid>
            </Grid>
        </StackPanel>

        <Viewbox HorizontalAlignment="Left" VerticalAlignment="Top" Grid.Row="1">
            <Grid x:Name="_gridMain" ShowGridLines="False">
                <Grid.RowDefinitions>
                    <RowDefinition Height="1"/>
                    <RowDefinition Height="680" />
                    <RowDefinition Height="160" />
                    <RowDefinition Height="20" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="680" />
                    <ColumnDefinition Width="270" />
                    <ColumnDefinition Width="600" />
                    <ColumnDefinition Width="1" />
                </Grid.ColumnDefinitions>
                <Viewbox x:Name="MainBoard" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Left" Height="680" Margin="0,0,0,0" VerticalAlignment="Top" Width="680" PreviewMouseWheel="OnPreviewMouseWheel">
                    <Canvas x:Name="MainCanvas" Grid.Column="0" HorizontalAlignment="Left" Height="680" Margin="0,0,0,0" VerticalAlignment="Top" Width="680" ContextMenuOpening="MainCanvas_ContextMenuOpening">
                        <Canvas.ContextMenu>
                            <ContextMenu  x:Name="UiMncMainBoard">
                                <MenuItem x:Name="UiMnciStartTrainingHere"  Header="{x:Static p:Resources.StartTrainingFromHere}" Click="UiMnStartTrainingHere_Click" InputGestureText="T" />
                                <MenuItem x:Name="UiMnciRestartTraining"  Header="{x:Static p:Resources.RestartTraining}" Click="UiMnTrainRestartTraining_Click"/>
                                <MenuItem x:Name="UiMnciExitTraining" Header="{x:Static p:Resources.ExitTraining}" Click="UiMnStopTraining_Click"/>
                                <Separator x:Name="UiMncMainBoardSepar_1" />
                                <MenuItem x:Name="UiMnMain_CreateExercise" Header="{x:Static p:Resources.CreateExerciseFromHere}" Click="UiMn_CreateExercise_Click"  />
                                <MenuItem x:Name="UiMnciCopyFen" Header="{x:Static p:Resources.CopyFENtoClipboard}" Click="UiMnciCopyFen_Click" InputGestureText="Ctrl+E" />
                                <Separator x:Name="UiMncMainBoardSepar_1a" />
                                <MenuItem x:Name="UiMnciEvalPos" Header="{x:Static p:Resources.EvaluatePosition}" Click="UiMnEvaluatePosition_Click" />
                                <MenuItem x:Name="UiMnciDontSaveEvals" Header="{x:Static p:Resources.DoNotUpdatePositionEval}" IsCheckable="True" Click="UiMnDontSaveEvals_Click" InputGestureText="Ctrl+K" />
                                <Separator x:Name="UiMnciSepar_EvalPos" />
                                <MenuItem x:Name="UiMnciEvalLine" Header="{x:Static p:Resources.EvaluateLine}" Click="UiMnEvaluateLine_Click" />
                                <Separator x:Name="UiMnciSepar_EvalLine" />
                                <MenuItem x:Name="UiMnciFindIdentical" Header="{x:Static p:Resources.FindIdenticalPosition}" Click="UiMnFindIdenticalPosition_Click" InputGestureText="F3"/>
                                <MenuItem x:Name="UiMnciFindPositions" Header="{x:Static p:Resources.SearchByFen}"  Click="UiMnFindPositions_Click" InputGestureText="Shift+F3" />
                                <Separator x:Name="UiMncMainBoardSepar_2" />
                                <MenuItem x:Name="UiMnciBookmarkPosition" Header="{x:Static p:Resources.BookmarkThisPosition}" Click="UiMnMarkBookmark_Click" />
                                <MenuItem x:Name="UiMnciDeleteBookmark" Visibility="Collapsed" Header="{x:Static p:Resources.DeleteThisBookmark}" Click="UiMnciDeleteBookmark_Click" />
                                <MenuItem x:Name="UiMnciSaveDiagram" Visibility="Visible" Header="{x:Static p:Resources.SaveDiagramAsImage}" Click="UiMn_SaveDiagramMainBoard_Click" />
                                <Separator x:Name="UiMncMainBoardSepar_4" />
                                <MenuItem x:Name="UiMnciReplay" Header="{x:Static p:Resources.Replay}"  Click="UiMnReplayLine_Clicked"/>
                                <Separator x:Name="UiMncMainBoardSepar_3" />
                                <MenuItem x:Name="UiMnciPlayEngine" Header="{x:Static p:Resources.PlayAgainstComputer}" Click="UiMnPlayEngine_Click" />
                                <MenuItem x:Name="UiMnciExitEngineGame" Header="{x:Static p:Resources.ExitGame}" Click="UiMnExitEngineGame_Click" />
                            </ContextMenu>
                        </Canvas.ContextMenu>
                        <Canvas.Background>
                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                        </Canvas.Background>
                        <Canvas x:Name="UiCnvDarkShade" Visibility="Collapsed" Margin="20,20,20,20" HorizontalAlignment="Left" 
                                VerticalAlignment="Top" Width="640" Height="640" Grid.Column="0" 
                                Background="Black" Opacity="0.1" Panel.ZIndex="20" >
                        </Canvas>
                        <Image x:Name="UiImgMainChessboard" Margin="20,20,20,20" Source="Resources/Images/ChessBoardBlue.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="640" Height="640" Grid.Column="0" />
                        <Label x:Name="UiLblEvalBarHost" Content=""  FontSize="8" Padding="0,8,0,8" HorizontalContentAlignment="Center" Foreground="White" Canvas.Left="663" Canvas.Top="20" Width="14" Height="640" Background="SlateGray" Panel.ZIndex="1" Visibility="Collapsed" MouseMove="UiLblEvalBarHost_MouseMove" MouseLeave="UiLblEvalBarHost_MouseLeave" />
                        <Label x:Name="UiLblEvalBarWhite" Content="" FontSize="8" Padding="0,8,0,8" HorizontalContentAlignment="Center" Foreground="Black" Canvas.Left="663" Canvas.Top="20" Width="14" Height="320" Background="WhiteSmoke" Panel.ZIndex="2" Visibility="Collapsed" MouseMove="UiLblEvalBarWhite_MouseMove" MouseLeave="UiLblEvalBarWhite_MouseLeave"/>
                        <Label x:Name="UiLblEvalFloat" Style="{StaticResource RoundedBorder}" Content="" FontSize="10" FontWeight="Bold" Padding="0,0,0,0" HorizontalContentAlignment="Center" Canvas.Left="654" Canvas.Top="332" Width="32" Height="16" Background="WhiteSmoke" Panel.ZIndex="3" Visibility="Collapsed" MouseMove="UiLblEvalFloat_MouseMove" MouseLeave="UiLblEvalFloat_MouseLeave"/>
                    </Canvas>
                </Viewbox>

                <DataGrid x:Name="UiDgEngineGame" Grid.Column="1" Grid.ColumnSpan="2" HorizontalAlignment="Right" Height="648" Margin="10,27,0,0" VerticalAlignment="Top" Width="180"  
                  SelectionMode="Single" SelectionUnit="Cell" AutoGenerateColumns="False" ItemsSource="{Binding}" IsReadOnly="True" CanUserSortColumns="False"
                  GridLinesVisibility="None" Grid.Row="1" Background="White" PreviewMouseDown="EngineGame_OnPreviewMouseDown"  PreviewMouseUp="EngineGame_OnPreviewMouseUp"   >
                    <DataGrid.Resources>
                        <Style x:Key="DisableSelection" TargetType="{x:Type DataGridCell}">
                            <Setter Property="Focusable" Value="False"/>
                        </Style>
                    </DataGrid.Resources>
                    <DataGrid.RowStyle>
                        <Style TargetType="{x:Type DataGridRow}">
                            <Setter Property="IsHitTestVisible" Value="False"/>
                        </Style>
                    </DataGrid.RowStyle>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="#" Width="30" Binding="{Binding Number}" CellStyle="{StaticResource DisableSelection}" CanUserReorder="False" />
                        <DataGridTextColumn Header="{x:Static p:Resources.White}" Width="60" Binding="{Binding WhitePly}" CanUserReorder="False" />
                        <DataGridTextColumn Header="{x:Static p:Resources.Black}" Width="60" Binding="{Binding BlackPly}" CanUserReorder="False"/>
                    </DataGrid.Columns>
                </DataGrid>
                <TabControl x:Name="UiTabCtrlTraining" Grid.Column="1" Grid.ColumnSpan="2" HorizontalAlignment="Left" Margin="20,5,20,0" Grid.Row="1" 
                    VerticalAlignment="Top" Grid.RowSpan="1" Visibility="Hidden">
                    <TabItem x:Name="UiTabTrainingProgress"  Header="{x:Static p:Resources.Training}" IsVisibleChanged="UiTabTrainingProgress_IsVisibleChanged">
                        <Grid Background="#FFE5E5E5">
                            <Grid.ContextMenu>
                                <ContextMenu x:Name="UiMncTrainingView">
                                    <MenuItem x:Name="_mnTrainRestartTraining" Header="{x:Static p:Resources.RestartTrainingSession}" Click="UiMnTrainRestartTraining_Click" />
                                    <MenuItem x:Name="_mnTrainExitTraining" Header="{x:Static p:Resources.ExitTraining}"  Click="UiMnStopTraining_Click" />
                                    <Separator x:Name="_mnTrainSepar_1" />
                                    <MenuItem x:Name="_mnTrainRestartGame" Header="{x:Static p:Resources.RestartGameAfter}" Click="UiMnTrainRestartGame_Click" />
                                    <MenuItem x:Name="_mnRollBackTraining" Header="{x:Static p:Resources.RestartFrom}" Click="UiMnRollBackTraining_Click" />
                                    <MenuItem x:Name="UiMncTrainReplaceEngineMove" Header="{x:Static p:Resources.ReplaceEngineMove}"  Click="UiMnReplaceEngineMove_Click" />
                                    <Separator x:Name="_mnTrainSepar_2" />
                                    <MenuItem x:Name="_mnTrainEvalMove" Header="{x:Static p:Resources.EvaluatePosition}" Click="UiMnTrainEvalMove_Click" />
                                    <MenuItem x:Name="_mnTrainEvalLine" Header="{x:Static p:Resources.EvaluateLine}" Click="UiMnTrainEvalLine_Click" />
                                </ContextMenu>
                            </Grid.ContextMenu>
                            <RichTextBox x:Name="UiRtbTrainingProgress" IsUndoEnabled="False"  ContextMenu="{x:Null}" HorizontalAlignment="Left" Margin="2,2,2,2" VerticalAlignment="Top" Grid.ColumnSpan="3" FontSize="14"
                                 SelectionOpacity="0" Cursor="Arrow" Background="White" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                                 IsReadOnly="True"  MinHeight="640" PreviewMouseMove="TrainingView_OnPreviewMouseMove" GotFocus="UiRtbTrainingProgress_GotFocus" PreviewMouseRightButtonDown="TrainingView_PreviewMouseRightButtonDown">
                                <RichTextBox.Resources>
                                    <Style TargetType="{x:Type Paragraph}">
                                        <Setter Property="Margin" Value="0" />
                                    </Style>
                                </RichTextBox.Resources>
                                <FlowDocument>
                                </FlowDocument>
                            </RichTextBox>
                            <Viewbox x:Name="UiVbTrainingFloatingBoard" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Hidden" Margin="0,0" Height="160" Width="160"  >
                                <Canvas x:Name="_cnvTrainingFloat" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244">
                                    <Canvas.Background>
                                        <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                    </Canvas.Background>
                                    <Image x:Name="_imgTrainingFloatingBoard" Margin="2,2,0,0" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" />
                                </Canvas>
                            </Viewbox>
                        </Grid>
                    </TabItem>
                </TabControl>
                <TabControl x:Name="UiTabCtrlEngineGame" Grid.Column="1" Grid.ColumnSpan="2" HorizontalAlignment="Left" Margin="20,5,20,0" Grid.Row="1" 
                    VerticalAlignment="Top" Grid.RowSpan="1" Visibility="Hidden">
                    <TabItem x:Name="UiTabEngineGame"  Header="{x:Static p:Resources.GameAgainstEngine}" IsVisibleChanged="UiTabEngineGame_IsVisibleChanged" 
                             PreviewKeyDown="UiTabEngineGame_PreviewKeyDown" PreviewKeyUp="UiTabEngineGame_PreviewKeyUp" PreviewMouseDown="UiTabEngineGame_PreviewMouseDown"  >
                        <Grid Background="#FFE5E5E5">
                            <Grid.ContextMenu>
                                <ContextMenu x:Name="UiMncEngineGame">
                                    <MenuItem x:Name="UiMnEngGame_SwapSides" Header="{x:Static p:Resources.EngGameSwapSides}" Click="UiMnEngGame_SwapSides_Click"  />
                                    <MenuItem x:Name="UiMnEngGame_RestartFromMove" Header="{x:Static p:Resources.EngGameRestartFrom}" Click="UiMnEngGame_RestartFromMove_Click"  />
                                    <MenuItem x:Name="UiMnEngGame_StartFromInit" Header="{x:Static p:Resources.EngGameStartFromInitial}" Click="UiMnEngGame_StartFromInit_Click"  />
                                    <Separator />
                                    <MenuItem x:Name="UiMnEngGame_ExitGame" Header="{x:Static p:Resources.ExitGame}" Click="UiMnEngGame_ExitGame_Click"  />
                                </ContextMenu>
                            </Grid.ContextMenu>
                            <RichTextBox x:Name="UiRtbEngineGame" IsUndoEnabled="False"  ContextMenu="{x:Null}" HorizontalAlignment="Left" Margin="2,2,2,2" VerticalAlignment="Top" Grid.ColumnSpan="3" FontSize="14"
                                 SelectionOpacity="0" Cursor="Arrow" Background="White" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                                 IsReadOnly="True"  MinHeight="640" >
                                <RichTextBox.Resources>
                                    <Style TargetType="{x:Type Paragraph}">
                                        <Setter Property="Margin" Value="0" />
                                    </Style>
                                </RichTextBox.Resources>
                                <FlowDocument>
                                </FlowDocument>
                            </RichTextBox>
                        </Grid>
                    </TabItem>
                </TabControl>
                <TabControl x:Name="UiTabCtrlManualReview" Grid.Column="1" Grid.ColumnSpan="2" HorizontalAlignment="Left" Margin="20,5,20,0" Grid.Row="1" VerticalAlignment="Top" Grid.RowSpan="1" IsVisibleChanged="UiTabCtrlManualReview_IsVisibleChanged"  PreviewMouseWheel="OnPreviewMouseWheel">
                    <TabItem x:Name="UiTabChapters"  Header="{x:Static p:Resources.Chapters}" GotFocus="UiTabChapters_GotFocus" 
                             PreviewKeyDown="ChessForgeMain_PreviewKeyDown" PreviewKeyUp="ChessForgeMain_PreviewKeyUp">
                        <Grid Background="#FFE5E5E5" PreviewMouseDown="Chapters_PreviewMouseDown" ContextMenuOpening="SupressContextMenu" PreviewMouseUp="Chapters_PreviewMouseUp" >
                            <Grid.ContextMenu>
                                <ContextMenu x:Name="UiMncChapters">
                                    <MenuItem x:Name="_mnAddChapter" Header="{x:Static p:Resources.CreateNewChapter}" Click="UiMnCreateNewChapter_Click"  />
                                    <MenuItem x:Name="_mnImportChapter" Header="{x:Static p:Resources.ImportNewChapter}" Click="UiMnImportChapter_Click" />
                                    <MenuItem x:Name="_mnImportModelGames" Header="{x:Static p:Resources.ImportGames}" Click="UiMnImportModelGames_Click" />
                                    <MenuItem x:Name="_mnImportExercises" Header="{x:Static p:Resources.ImportExercises}" Click="UiMnImportExercises_Click" />
                                    <MenuItem x:Name="_mnAddGame" Header="{x:Static p:Resources.CreateNewGame}" Click="UiMnChpt_CreateModelGame_Click"  />
                                    <MenuItem x:Name="_mnImportGame" Header="{x:Static p:Resources.ImportGames}" Click="UiMnImportModelGames_Click" />
                                    <MenuItem x:Name="_mnAddExercise" Header="{x:Static p:Resources.CreateNewExercise}" Click="UiMnChpt_AddExercise_Click"  />
                                    <MenuItem x:Name="_mnImportExercise" Header="{x:Static p:Resources.ImportExercises}" Click="UiMnImportExercises_Click" />
                                    <Separator />
                                    <MenuItem x:Name="_mnSelectChapter" Header="{x:Static p:Resources.OpenSelectedChapter}" Click="UiMnSelectChapter_Click" />
                                    <MenuItem x:Name="_mnRenameChapter" Header="{x:Static p:Resources.RenameSelectedChapter}" Click="UiMnRenameChapter_Click" />
                                    <MenuItem x:Name="UiMnChptCreateIntro" Header="{x:Static p:Resources.CreateIntro}" Click="UiMnChptCreateIntro_Click" />
                                    <MenuItem x:Name="_mnSelectGame" Header="{x:Static p:Resources.OpenSelectedGame}" Click="UiMnOpenGame_Click"  />
                                    <MenuItem x:Name="_mnRenameGame" Header="{x:Static p:Resources.EditGameHeaders}" Click="UiMnEditGameHeader_Click" />
                                    <MenuItem x:Name="_mnSelectExercise" Header="{x:Static p:Resources.OpenThisExercise}" Click="UiMnOpenExercise_Click"  />
                                    <MenuItem x:Name="_mnRenameExercise" Header="{x:Static p:Resources.EditExerciseHeaders}" Click="UiMnEditExerciseHeader_Click" />
                                    <MenuItem x:Name="_mnMergeChapters" Header="{x:Static p:Resources.MergeChapters}" Click="UiMnMergeChapters_Click" />
                                    <Separator />
                                    <MenuItem x:Name="_mnChapterUp" Header="{x:Static p:Resources.MoveChapterUp}" Click="UiMnChapterUp_Click" InputGestureText="Ctrl+U"/>
                                    <MenuItem x:Name="_mnChapterDown" Header="{x:Static p:Resources.MoveChapterDown}" Click="UiMnChapterDown_Click"  InputGestureText="Ctrl+D" />
                                    <MenuItem x:Name="_mnGameUp" Header="{x:Static p:Resources.MoveGameUp}" Click="UiMnGameUp_Click"  InputGestureText="Ctrl+U" />
                                    <MenuItem x:Name="_mnGameDown" Header="{x:Static p:Resources.MoveGameDown}" Click="UiMnGameDown_Click"  InputGestureText="Ctrl+D" />
                                    <MenuItem x:Name="_mnGameToChapter" Header="{x:Static p:Resources.MoveGameToChapter}" Click="UiMnMoveGameToChapter_Click" />
                                    <MenuItem x:Name="_mnExerciseUp" Header="{x:Static p:Resources.MoveExerciseUp}" Click="UiMnExerciseUp_Click"  InputGestureText="Ctrl+U"/>
                                    <MenuItem x:Name="_mnExerciseDown" Header="{x:Static p:Resources.MoveExerciseDown}" Click="UiMnExerciseDown_Click" InputGestureText="Ctrl+D" />
                                    <MenuItem x:Name="_mnExerciseToChapter" Header="{x:Static p:Resources.MoveExerciseToChapter}" Click="UiMnMoveExerciseToChapter_Click" />
                                    <Separator />
                                    <MenuItem x:Name="_mnDeleteChapter" Header="{x:Static p:Resources.DeleteSelectedChapter}" Click="UiMnDeleteChapter_Click" />
                                    <MenuItem x:Name="_mnDeleteGame" Header="{x:Static p:Resources.DeleteThisGame}" Click="UiMnChpt_DeleteGame_Click" />
                                    <MenuItem x:Name="_mnDeleteExercise" Header="{x:Static p:Resources.DeleteThisExercise}" Click="UiMnChpt_DeleteExercise_Click" />
                                    <MenuItem x:Name="UiMnDeleteGames" Header="{x:Static p:Resources.DeleteGames}" Click="UiMnDeleteGames_Click" />
                                    <MenuItem x:Name="UiMnDeleteExercises" Header="{x:Static p:Resources.DeleteExercises}" Click="UiMnDeleteExercises_Click"  />
                                    <Separator />
                                    <MenuItem x:Name="UiMnChapterScores" Header="{x:Static p:Resources.ChapterStats}" Click="UiMnChapterStats_Click" />
                                    <MenuItem x:Name="UiMnWorkbookScores" Header="{x:Static p:Resources.WorkbookStats}" Click="UiMnWorkbookStats_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnChptExpandChapters" Header="{x:Static p:Resources.ExpandChapters}" Click="UiMnChptExpandChapters_Click" />
                                    <MenuItem x:Name="UiMnChptCollapseChapters" Header="{x:Static p:Resources.CollapseChapters}" Click="UiMnChptCollapseChapters_Click" />
                                    <MenuItem x:Name="UiMnChptExpandAll" Header="{x:Static p:Resources.ExpandAll}" Click="UiMnChptExpandAll_Click" InputGestureText="Ctrl +" />
                                    <MenuItem x:Name="UiMnChptCollapseAll" Header="{x:Static p:Resources.CollapseAll}" Click="UiMnChptCollapseAll_Click" InputGestureText="Ctrl -" />
                                </ContextMenu>
                            </Grid.ContextMenu>
                            <RichTextBox x:Name="UiRtbChaptersView" Grid.Row="1"  ContextMenu="{x:Null}" IsUndoEnabled="False" HorizontalAlignment="Left" 
                                         Margin="2,2,2,2" VerticalAlignment="Top" Grid.ColumnSpan="3" FontSize="14"
                                         SelectionOpacity="0" Cursor="Arrow" Background="White" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                                         Height="640" MinHeight="500" IsReadOnly="True" MouseLeftButtonUp="UiRtbChaptersView_MouseLeftButtonUp" 
                                         MouseEnter="UiRtbChaptersView_MouseEnter" MouseLeave="UiRtbChaptersView_MouseLeave" MouseMove="UiRtbChaptersView_MouseMove" LayoutUpdated="UiRtbChaptersView_LayoutUpdated" >
                                <RichTextBox.Resources>
                                    <Style TargetType="{x:Type Paragraph}">
                                        <Setter Property="Margin" Value="0" />
                                    </Style>
                                </RichTextBox.Resources>
                                <FlowDocument>
                                </FlowDocument>
                            </RichTextBox>
                            <Image x:Name="UiImgChapterArrowDown" Grid.Row="1" Margin="0,30,30,0" Source="Resources/Images/ChapterDnArrow.png" HorizontalAlignment="Right" 
                                   VerticalAlignment="Top" Width="32" Height="32" Opacity="0.8" Cursor="Hand" ToolTip="{x:Static p:Resources.ToolTipScrollEnd}" PreviewMouseDown="UiImgChapterArrowDown_PreviewMouseDown" />
                            <Image x:Name="UiImgChapterArrowUp" Grid.Row="1" Margin="0,0,30,30" Source="Resources/Images/ChapterUpArrow.png" HorizontalAlignment="Right" 
                                   VerticalAlignment="Bottom" Width="32" Height="32" Opacity="0.8" Cursor="Hand" ToolTip="{x:Static p:Resources.ToolTipScrollHome}" PreviewMouseDown="UiImgChapterArrowUp_PreviewMouseDown" />
                            <Viewbox x:Name="UiVbChaptersFloatingBoard" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Hidden" Margin="0,0" Height="160" Width="160"  >
                                <Canvas x:Name="_cnvChaptersFloat" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244">
                                    <Canvas.Background>
                                        <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                    </Canvas.Background>
                                    <Image x:Name="_imgChaptersFloatingBoard" Margin="2,2,0,0" Source="Resources/Images/ChessBoardBlueSmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" />
                                </Canvas>
                            </Viewbox>
                            <Viewbox x:Name="UiVbExerciseFloatingBoard" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Hidden" Margin="0,0" Height="160" Width="160"  >
                                <Canvas x:Name="_cnvExerciseFloat" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244">
                                    <Canvas.Background>
                                        <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                    </Canvas.Background>
                                    <Image x:Name="_imgExerciseFloatingBoard" Margin="2,2,0,0" Source="Resources/Images/ChessBoardLightGreenSmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" />
                                </Canvas>
                            </Viewbox>
                            <Viewbox x:Name="UiVbModelGameFloatingBoard" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Hidden" Margin="0,0" Height="160" Width="160"  >
                                <Canvas x:Name="_cnvModelGameFloat" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244">
                                    <Canvas.Background>
                                        <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                    </Canvas.Background>
                                    <Image x:Name="_imgModelGameFloatingBoard" Margin="2,2,0,0" Source="Resources/Images/ChessBoardLightBlueSmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" />
                                </Canvas>
                            </Viewbox>
                        </Grid>
                    </TabItem>
                    <TabItem x:Name="UiTabIntro" Header="{x:Static p:Resources.Intro}" GotFocus="UiTabIntro_GotFocus" LostFocus="UiTabIntro_LostFocus"  >
                        <Grid x:Name="UiGridIntro" Background="#FFE5E5E5" >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="20"/>
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid x:Name="UiGridIntroIcons" Grid.Row="0" HorizontalAlignment="Left"  >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30"/>
                                    <ColumnDefinition Width="70 "/>
                                    <ColumnDefinition Width="50 "/>
                                    <ColumnDefinition Width="50 "/>
                                </Grid.ColumnDefinitions>
                                <Grid.Resources>
                                    <Style TargetType="{x:Type Button}" x:Key="formatImageStyle">
                                        <Setter Property="Height" Value="16"></Setter>
                                        <Setter Property="Width" Value="16"></Setter>
                                        <Setter Property="BorderThickness" Value="0"></Setter>
                                        <Setter Property="CommandTarget" Value="{Binding ElementName=UiRtbIntroView}"></Setter>
                                        <Setter Property="Background" Value="Transparent"></Setter>
                                    </Style>
                                </Grid.Resources>
                                <Button x:Name="UiBtnIntroUndo" Style="{StaticResource formatImageStyle}" Grid.Column="0"  Margin="10,0,0,0" HorizontalAlignment="Left"   ToolTip="{x:Static p:Resources.Undo}" Command="ApplicationCommands.Undo" >
                                    <Image Source="Resources/Images/undo_16.png"></Image>
                                </Button>
                                <Button x:Name="UiBtnIntroToggleBold" Style="{StaticResource formatImageStyle}" Grid.Column="1" Margin="10,0,0,0" HorizontalAlignment="Left"  ToolTip="{x:Static p:Resources.FontBold}" Click="UiBtnIntroToggleBold_Click">
                                    <Image Source="Resources/Images/format_bold.png"></Image>
                                </Button>
                                <Button x:Name="UiBtnIntroToggleItalic" Style="{StaticResource formatImageStyle}" Grid.Column="1" Margin="30,0,0,0" HorizontalAlignment="Left" ToolTip="{x:Static p:Resources.FontItalic}" Click="UiBtnIntroToggleItalic_Click">
                                    <Image Source="Resources/Images/format_italic.png"></Image>
                                </Button>
                                <Button x:Name="UiBtnIntroToggleUnderline" Style="{StaticResource formatImageStyle}" Grid.Column="1" Margin="50,0,0,0" HorizontalAlignment="Left" ToolTip="{x:Static p:Resources.FontUnderline}" Click="UiBtnIntroToggleUnderline_Click">
                                    <Image Source="Resources/Images/format_underline.png"></Image>
                                </Button>
                                <Button x:Name="UiBtnIntroFontSizeUp" Style="{StaticResource formatImageStyle}" Grid.Column="2" Margin="10,0,0,0" HorizontalAlignment="Left"   ToolTip="{x:Static p:Resources.IncreaseFontSize}" Click="UiBtnIntroFontSizeUp_Click" >
                                    <Image Source="Resources/Images/FontSizeUp.png"></Image>
                                </Button>
                                <Button x:Name="UiBtnIntroFontSizeDown"  Style="{StaticResource formatImageStyle}" Grid.Column="2" Margin="30,0,0,0" HorizontalAlignment="Left"  ToolTip="{x:Static p:Resources.DecreaseFontSize}" Click="UiBtnIntroFontSizeDown_Click">
                                    <Image Source="Resources/Images/FontSizeDown.png"></Image>
                                </Button>
                                <Button x:Name="UiBtnIntroIncreaseIndent" Style="{StaticResource formatImageStyle}" Grid.Column="3" Margin="10,0,0,0" HorizontalAlignment="Left" ToolTip="{x:Static p:Resources.IncreaseIndent}" Click="UiBtnIntroIncreaseIndent_Click">
                                    <Image Source="Resources/Images/right_indent.png"></Image>
                                </Button>
                                <Button x:Name="UiBtnIntroDecreaseIndent" Style="{StaticResource formatImageStyle}" Grid.Column="3" Margin="30,0,0,0" HorizontalAlignment="Left" ToolTip="{x:Static p:Resources.DecreaseIndent}" Click="UiBtnIntroDecreaseIndent_Click">
                                    <Image Source="Resources/Images/left_indent.png"></Image>
                                </Button>
                            </Grid>
                            <Label x:Name="UiIntroLblChapterTitle" Height="30" MaxWidth="400" Content="" HorizontalAlignment="Center" HorizontalContentAlignment="Center" Margin="0,-3,0,0" FontWeight="Normal" FontStyle="Normal" MouseDoubleClick="UiIntroLblChapterTitle_MouseDoubleClick"  />
                            <Grid x:Name="UiGridIntroPrevNext" Grid.Row="0" HorizontalAlignment="Right" VerticalAlignment="Top" Visibility="Visible" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto "/>
                                </Grid.RowDefinitions>
                                <Image x:Name="UiIntroImgLeftArrowChapter" Grid.Column="0" Cursor="Hand"  HorizontalAlignment="Left"  Margin="0,0,10,0" Source="Resources/Images/LeftArrowChapters.png" PreviewMouseLeftButtonDown="UiImgChapterLeftArrow_PreviewMouseLeftButtonDown"  />
                                <Label x:Name="UiIntroLblCounterChapter" Grid.Column="1" Content="" HorizontalAlignment="Right" HorizontalContentAlignment="Left" Margin="0,-3,10,0" FontWeight="Bold"/>
                                <Image x:Name="UiIntroImgRightArrowChapter" Grid.Column="2" Cursor="Hand"  HorizontalAlignment="Right" Margin="0,0,10,0" Source="Resources/Images/RightArrowChapters.png" PreviewMouseLeftButtonDown="UiImgChapterRightArrow_PreviewMouseLeftButtonDown"  />
                            </Grid>
                            <RichTextBox x:Name="UiRtbIntroView"  Grid.Row="1" HorizontalAlignment="Left" Margin="2,2,2,2" VerticalAlignment="Top" Grid.ColumnSpan="3" FontSize="14"
                                 Cursor="Arrow" Background="White" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                                   Height="620" MinHeight="500" PreviewMouseDown="UiRtbIntroView_PreviewMouseDown"  AcceptsTab="True" PreviewKeyDown="UiRtbIntroView_PreviewKeyDown" PreviewTextInput="UiRtbIntroView_PreviewTextInput" SelectionChanged="UiRtbIntroView_SelectionChanged" >
                                <RichTextBox.CommandBindings>
                                    <CommandBinding Command="ApplicationCommands.Undo"  Executed="IntroViewUndo_Click"/>
                                    <CommandBinding Command="ApplicationCommands.Copy"  Executed="IntroViewCopy_Click"/>
                                    <CommandBinding Command="ApplicationCommands.Paste" Executed="IntroViewPaste_Click"/>
                                    <CommandBinding Command="ApplicationCommands.Cut"   Executed="IntroViewCut_Click"/>
                                </RichTextBox.CommandBindings>
                                <RichTextBox.ContextMenu>
                                    <ContextMenu x:Name="UiMncIntro">
                                        <MenuItem Command="ApplicationCommands.Cut"/>
                                        <MenuItem Command="ApplicationCommands.Copy"/>
                                        <MenuItem Command="ApplicationCommands.Paste"/>
                                        <Separator></Separator>
                                        <MenuItem x:Name="UiCmiInsertDiagram" Header="{x:Static p:Resources.InsertDiagram}" Click="UiCmiInsertDiagram_Click"  />
                                        <MenuItem x:Name="UiCmiEditDiagram" Header="{x:Static p:Resources.EditDiagram}" Click="UiCmiEditDiagram_Click"  />
                                        <MenuItem x:Name="UiCmiSaveDiagram" Header="{x:Static p:Resources.SaveDiagramAsImage}" Click="UiMn_SaveDiagram_Click"  />
                                        <MenuItem x:Name="UiCmiInsertHyperlink" Header="{x:Static p:Resources.InsertHyperlink}"  Click="UiCmiInsertHyperlink_Click"  />
                                        <MenuItem x:Name="UiCmiEditHyperlink" Header="{x:Static p:Resources.EditHyperlink}" Click="UiCmiEditHyperlink_Click"   />
                                        <MenuItem x:Name="UiCmiFlipDiagram" Header="{x:Static p:Resources.FlipBoard}" Click="UiCmiFlipDiagram_Click"  />
                                        <MenuItem x:Name="UiCmiEditMove" Header="{x:Static p:Resources.EditMove}" Click="UiCmiEditMove_Click"  />
                                        <Separator/>
                                        <MenuItem x:Name="UiCmiIntroFindIdentical" Header="{x:Static p:Resources.FindIdenticalPosition}"  Click="UiMnFindIdenticalPosition_Click" InputGestureText="F3" />
                                    </ContextMenu>
                                </RichTextBox.ContextMenu>
                                <RichTextBox.Resources>
                                    <Style TargetType="{x:Type Paragraph}">
                                        <Setter Property="Margin" Value="0,0,0,0" />
                                    </Style>
                                </RichTextBox.Resources>
                                <FlowDocument>
                                </FlowDocument>
                            </RichTextBox>
                        </Grid>
                    </TabItem>
                    <TabItem x:Name="UiTabStudyTree"  Header="{x:Static p:Resources.Study}" GotFocus="UiTabStudyTree_GotFocus" PreviewKeyDown="ChessForgeMain_PreviewKeyDown" PreviewKeyUp="ChessForgeMain_PreviewKeyUp">
                        <Grid x:Name="UiGridStudyTree"  Background="#FFE5E5E5" PreviewMouseDown="VariationTreeView_OnPreviewMouseDown" ContextMenuOpening="SupressContextMenu"
                              >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="20"/>
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.ContextMenu>
                                <ContextMenu x:Name="UiMncStudyTree">
                                    <MenuItem x:Name="UiMnStudyStartTrainingHere"  Header="{x:Static p:Resources.StartTrainingFromHere}" Click="UiMnStartTrainingHere_Click" InputGestureText="T" />
                                    <MenuItem x:Name="UiMnStudy_CreateExercise" Header="{x:Static p:Resources.CreateExerciseFromHere}" Click="UiMn_CreateExercise_Click"  />
                                    <MenuItem x:Name="UiMnStudyMarkThumbnail" Header="{x:Static p:Resources.MarkAsThumbnail}" Click="UiMn_MarkThumbnail_Click" InputGestureText="Ctrl+T" />
                                    <MenuItem x:Name="UiMnMarkBookmark" Header="{x:Static p:Resources.BookmarkThisPosition}" Click="UiMnMarkBookmark_Click" />
                                    <MenuItem x:Name="UiMnStDeleteBookmark" Visibility="Collapsed" Header="{x:Static p:Resources.DeleteThisBookmark}" Click="UiMnciDeleteBookmark_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnStudyInsertDiagramPreComment" Header="{x:Static p:Resources.InsertDiagramPreComment}"  Click="UiMn_InsertPreCommentDiagram_Click" InputGestureText="Ctrl+I" />
                                    <MenuItem x:Name="UiMnStudyInsertDiagramPostComment" Header="{x:Static p:Resources.InsertDiagramPostComment}"  Click="UiMn_InsertPostCommentDiagram_Click" InputGestureText="Ctrl+J" />
                                    <MenuItem x:Name="UiMnStudyDeleteDiagram" Visibility="Collapsed" Header="{x:Static p:Resources.RemoveDiagram}" Click="UiMn_DeleteDiagram_Click" InputGestureText="Ctrl+I" />
                                    <MenuItem x:Name="UiMnStudySwapDiagramComment" Visibility="Collapsed" Header="{x:Static p:Resources.SwapDiagramComment}" Click="UiMn_SwapDiagramComment_Click" />
                                    <MenuItem x:Name="UiMnStudyInvertDiagram" Header="{x:Static p:Resources.InvertDiagram}"  Click="UiMn_InvertDiagram_Click" />
                                    <MenuItem x:Name="UiMnStudySaveDiagram" Header="{x:Static p:Resources.SaveDiagramAsImage}"  Click="UiMn_SaveDiagram_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnPromoteLine" Header="{x:Static p:Resources.PromoteLine}" Click="UiMnPromoteLine_Click" InputGestureText="P" />
                                    <MenuItem x:Name="UiMnReorderLines" Header="{x:Static p:Resources.ReorderLines}" Click="UiMnReorderLines_Click" />
                                    <MenuItem x:Name="UiMnEnterNullMove" Header="{x:Static p:Resources.EnterNullMove}" Click="UiMnEnterNullMove_Click" />
                                    <MenuItem x:Name="UiMnDuplicateAsVariation" Header="{x:Static p:Resources.DuplicateAsVariation}" Click="UiMnDuplicateAsVariation_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnRegenerateStudy" Header="{x:Static p:Resources.RegenerateStudyTree}" Click="UiMnRegenerateStudy_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnDeleteMovesFromHere" Header="{x:Static p:Resources.DeleteMovesFromHere}" Click="UiMnDeleteMovesFromHere_Click" InputGestureText="Del" />
                                    <MenuItem x:Name="UiMnCreateChapterFromLine" Header="{x:Static p:Resources.CreateNewChapterFromLine}" Click="UiMnCreateChapterFromLine_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnStudyWorkbookEvalMove" Header="{x:Static p:Resources.EvaluatePosition}"  Click="UiMnEvaluatePosition_Click" />
                                    <MenuItem x:Name="UiMnStudyDontSaveEvals" Header="{x:Static p:Resources.DoNotUpdatePositionEval}" IsCheckable="True" Click="UiMnDontSaveEvals_Click" InputGestureText="Ctrl+K" />
                                    <Separator x:Name="UiMnStudySepar_EvalPos" />
                                    <MenuItem x:Name="UiMnStudyEvalLine" Header="{x:Static p:Resources.EvaluateLine}"  Click="UiMnEvaluateLine_Click" />
                                    <Separator x:Name="UiMnStudySepar_EvalLine" />
                                    <MenuItem x:Name="UiMnStudyFindIdentical" Header="{x:Static p:Resources.FindIdenticalPosition}"  Click="UiMnFindIdenticalPosition_Click" InputGestureText="F3" />
                                    <MenuItem x:Name="UiMnStudyFindPositions" Header="{x:Static p:Resources.SearchByFen}"  Click="UiMnFindPositions_Click" InputGestureText="Shift+F3" />
                                </ContextMenu>
                            </Grid.ContextMenu>
                            <Label x:Name="UiStudyLblChapterTitle" Height="30" Content="" MaxWidth="320" HorizontalAlignment="Center" HorizontalContentAlignment="Center" Margin="-150,-3,10,0" FontWeight="Normal" FontStyle="Normal" MouseDoubleClick="UiStudyLblChapterTitle_MouseDoubleClick"  />
                            <Grid x:Name="UiGridStudyTreePrevNext" Grid.Row="0" Panel.ZIndex="1" HorizontalAlignment="Right" VerticalAlignment="Top" Visibility="Visible" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto "/>
                                </Grid.RowDefinitions>
                                <Image x:Name="UiImgChapterLeftArrow" Grid.Column="0" Cursor="Hand"  HorizontalAlignment="Left"  Margin="0,0,10,0" Source="Resources/Images/LeftArrowChapters.png" PreviewMouseLeftButtonDown="UiImgChapterLeftArrow_PreviewMouseLeftButtonDown"  />
                                <Label x:Name="UiLblChapterCounter" Grid.Column="1" Content="" HorizontalAlignment="Right" HorizontalContentAlignment="Left" Margin="0,-3,10,0" FontWeight="Bold"/>
                                <Image x:Name="UiImgChapterRightArrow" Grid.Column="2" Cursor="Hand"  HorizontalAlignment="Right" Margin="0,0,10,0" Source="Resources/Images/RightArrowChapters.png" PreviewMouseLeftButtonDown="UiImgChapterRightArrow_PreviewMouseLeftButtonDown"  />
                            </Grid>
                            <RichTextBox x:Name="UiRtbStudyTreeView"  ContextMenu="{x:Null}" IsUndoEnabled="False"  Grid.Row="1" HorizontalAlignment="Left" Margin="2,2,2,2" VerticalAlignment="Top" Grid.ColumnSpan="3" FontSize="14"
                                 SelectionOpacity="0" Cursor="Arrow" Background="White" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                                   Height="600" MinHeight="500" IsReadOnly="True" PreviewKeyDown="UiRtbStudyTree_PreviewKeyDown">
                                <RichTextBox.Resources>
                                    <Style TargetType="{x:Type Paragraph}">
                                        <Setter Property="Margin" Value="0" />
                                    </Style>
                                </RichTextBox.Resources>
                                <FlowDocument>
                                </FlowDocument>
                            </RichTextBox>
                            <StackPanel x:Name="UiStpStNags" Orientation="Horizontal" Grid.Row="1" Grid.ColumnSpan="3" HorizontalAlignment="Center" Height="48" Margin="0,588,0,0" VerticalAlignment="Top">
                                <Button x:Name="UiBtnStPencil" Background="Transparent" Margin="0,0,0,0" Width="30" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnPencil_Click"  />
                                <Button x:Name="UiBtnStCommentBeforeMove" Background="Transparent" Margin="0,0,0,0" Width="30" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnCommentBeforeMove_Click"  />
                                <Button x:Name="UiBtnStEvalWin" Background="Transparent" Margin="30,0,0,0" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalWin_Click" />
                                <Button x:Name="UiBtnStEvalPlusMinus" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalPlusMinus_Click" />
                                <Button x:Name="UiBtnStEvalPlusEqual" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalPlusEqual_Click" />
                                <Button x:Name="UiBtnStEvalEqual" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalEqual_Click" />
                                <Button x:Name="UiBtnStEvalUnclear" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalUnclear_Click" />
                                <Button x:Name="UiBtnStEvalEqualPlus" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalEqualPlus_Click" />
                                <Button x:Name="UiBtnStEvalMinusPlus" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalMinusPlus_Click" />
                                <Button x:Name="UiBtnStEvalLoss" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalLoss_Click" />
                                <Button x:Name="UiBtnStEvalExclamExclam" Background="Transparent" Margin="30,0,0,0" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalExclamExclam_Click" />
                                <Button x:Name="UiBtnStEvalExclam" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalExclam_Click" />
                                <Button x:Name="UiBtnStEvalExclamQuest" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalExclamQuest_Click" />
                                <Button x:Name="UiBtnStEvalQuestExclam" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalQuestExclam_Click" />
                                <Button x:Name="UiBtnStEvalQuest" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalQuest_Click" />
                                <Button x:Name="UiBtnStEvalQuestQuest" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalQuestQuest_Click" />
                            </StackPanel>
                        </Grid>
                    </TabItem>
                    <TabItem x:Name="UiTabModelGames"  Header="{x:Static p:Resources.Games}" GotFocus="UiTabModelGames_GotFocus" PreviewKeyDown="UiTabModelGames_PreviewKeyDown" LostFocus="UiTabModelGames_LostFocus" >
                        <Grid x:Name="UiGridModelGames"  Background="#FFE5E5E5"  PreviewMouseDown="VariationTreeView_OnPreviewMouseDown" ContextMenuOpening="SupressContextMenu"
                              PreviewKeyDown="ChessForgeMain_PreviewKeyDown" PreviewKeyUp="ChessForgeMain_PreviewKeyUp">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="20"/>
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.ContextMenu>
                                <ContextMenu x:Name="UiMncModelGames">
                                    <MenuItem x:Name="UiMnGamesGame" Header="{x:Static p:Resources.Game}">
                                        <MenuItem x:Name="UiMnGameCreateModelGame" Header="{x:Static p:Resources.CreateNewGame}" Click="UiMnGame_CreateModelGame_Click" />
                                        <MenuItem x:Name="UiMnGameEditHeader" Header="{x:Static p:Resources.EditGameHeader}" Click="UiMnGame_EditHeader_Click" />
                                        <MenuItem x:Name="UiMnGameMoveToChapter" Header="{x:Static p:Resources.MoveGameToChapter}" Click="UiMnMoveGameToChapter_Click" />
                                        <Separator />
                                        <MenuItem x:Name="UiMnGameDeleteModelGame" Header="{x:Static p:Resources.DeleteThisGame}" Click="UiMnGame_DeleteModelGame_Click" />
                                        <Separator />
                                        <MenuItem x:Name="UiMnGamesImportGames" Header="{x:Static p:Resources.ImportGames}" Click="UiMnImportModelGames_Click"  />
                                    </MenuItem>
                                    <Separator />
                                    <MenuItem x:Name="UiMnGameStartTrainingFromHere"  Header="{x:Static p:Resources.StartTrainingFromHere}" Click="UiMnStartTrainingHere_Click" InputGestureText="T" />
                                    <MenuItem x:Name="UiMnGameCreateExercise" Header="{x:Static p:Resources.CreateExerciseFromHere}" Click="UiMnGame_CreateExercise_Click" />
                                    <MenuItem x:Name="UiMnGameMarkThumbnail" Header="{x:Static p:Resources.MarkAsThumbnail}" Click="UiMn_MarkThumbnail_Click" InputGestureText="Ctrl+T" />
                                    <MenuItem x:Name="UiMnGameMarkBookmark" Header="{x:Static p:Resources.BookmarkThisPosition}" Click="UiMnMarkBookmark_Click" />
                                    <MenuItem x:Name="UiMnGameDeleteBookmark" Visibility="Collapsed" Header="{x:Static p:Resources.DeleteThisBookmark}" Click="UiMnciDeleteBookmark_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnGameInsertDiagramPreComment" Header="{x:Static p:Resources.InsertDiagramPreComment}" Click="UiMn_InsertPreCommentDiagram_Click" InputGestureText="Ctrl+I" />
                                    <MenuItem x:Name="UiMnGameInsertDiagramPostComment" Header="{x:Static p:Resources.InsertDiagramPostComment}" Click="UiMn_InsertPostCommentDiagram_Click" InputGestureText="Ctrl+J" />
                                    <MenuItem x:Name="UiMnGame_DeleteDiagram" Visibility="Collapsed" Header="{x:Static p:Resources.RemoveDiagram}" Click="UiMn_DeleteDiagram_Click" InputGestureText="Ctrl+I" />
                                    <MenuItem x:Name="UiMnGameSwapDiagramComment" Visibility="Collapsed" Header="{x:Static p:Resources.SwapDiagramComment}" Click="UiMn_SwapDiagramComment_Click" />
                                    <MenuItem x:Name="UiMnGameInvertDiagram" Header="{x:Static p:Resources.InvertDiagram}"  Click="UiMn_InvertDiagram_Click" />
                                    <MenuItem x:Name="UiMnGameSaveDiagram" Header="{x:Static p:Resources.SaveDiagramAsImage}"  Click="UiMn_SaveDiagram_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnGamePromoteLine" Header="{x:Static p:Resources.PromoteLine}" Click="UiMnGame_PromoteLine_Click" InputGestureText="P"  />
                                    <MenuItem x:Name="UiMnGameReorderLines" Header="{x:Static p:Resources.ReorderLines}" Click="UiMnReorderLines_Click" />
                                    <MenuItem x:Name="UiMnGameEnterNullMove" Header="{x:Static p:Resources.EnterNullMove}" Click="UiMnEnterNullMove_Click" />
                                    <MenuItem x:Name="UiMnGameDuplicateAsVariation" Header="{x:Static p:Resources.DuplicateAsVariation}" Click="UiMnDuplicateAsVariation_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnGameDeleteMovesFromHere" Header="{x:Static p:Resources.DeleteMovesFromHere}" Click="UiMnGame_DeleteMovesFromHere_Click" InputGestureText="Del" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnGame_EvalMove" Header="{x:Static p:Resources.EvaluatePosition}"  Click="UiMnEvaluatePosition_Click" />
                                    <MenuItem x:Name="UiMnGameDontSaveEvals" Header="{x:Static p:Resources.DoNotUpdatePositionEval}" IsCheckable="True" Click="UiMnDontSaveEvals_Click" InputGestureText="Ctrl+K" />
                                    <Separator x:Name="UiMnGameSepar_EvalPos" />
                                    <MenuItem x:Name="UiMnGame_EvalLine" Header="{x:Static p:Resources.EvaluateLine}"  Click="UiMnEvaluateLine_Click" />
                                    <Separator x:Name="UiMnGameSepar_EvalLine" />
                                    <MenuItem x:Name="UiMnGameFindIdentical" Header="{x:Static p:Resources.FindIdenticalPosition}" Click="UiMnFindIdenticalPosition_Click" InputGestureText="F3" />
                                    <MenuItem x:Name="UiMnGameFindPositions" Header="{x:Static p:Resources.SearchByFen}"  Click="UiMnFindPositions_Click" InputGestureText="Shift+F3" />
                                </ContextMenu>
                            </Grid.ContextMenu>
                            <Grid x:Name="UiGridModelGamePrevNext" Grid.Row="0" Panel.ZIndex="1" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Visible" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto "/>
                                </Grid.RowDefinitions>
                                <Image x:Name="UiImgModelGameLeftArrow" Grid.Column="0" Cursor="Hand"  HorizontalAlignment="Left"  Margin="10,0,0,0" Source="Resources/Images/LeftArrow.png" PreviewMouseLeftButtonDown="UiPreviousModelGame_ButtonDown"  />
                                <Label x:Name="UiLblGameCounter" Grid.Column="1" Content="" HorizontalAlignment="Left" HorizontalContentAlignment="Left" Margin="10,-3,0,0" FontWeight="Bold"/>
                                <Image x:Name="UiImgModelGameRightArrow" Grid.Column="2" Cursor="Hand"  HorizontalAlignment="Right" Margin="10,0,0,0" Source="Resources/Images/RightArrow.png" PreviewMouseLeftButtonDown="UiNextModelGame_ButtonDown"  />
                            </Grid>
                            <Label x:Name="UiGamesLblChapterTitle" Grid.Column="0" Height="30" Content="" MaxWidth="220" HorizontalAlignment="Center" HorizontalContentAlignment="Center" Margin="0,-3,0,0" FontWeight="Normal" FontStyle="Normal" MouseDoubleClick="UiGamesLblChapterTitle_MouseDoubleClick"  />
                            <Grid x:Name="UiGridModelGamePrevNextChapter" Grid.Row="0" Panel.ZIndex="1" HorizontalAlignment="Right" VerticalAlignment="Top" Visibility="Visible" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto "/>
                                </Grid.RowDefinitions>
                                <Image x:Name="UiGamesImgLeftArrowChapter" Grid.Column="0" Cursor="Hand"  HorizontalAlignment="Left"  Margin="0,0,10,0" Source="Resources/Images/LeftArrowChapters.png" PreviewMouseLeftButtonDown="UiImgChapterLeftArrow_PreviewMouseLeftButtonDown"  />
                                <Label x:Name="UiGamesLblCounterChapter" Grid.Column="1" Content="" HorizontalAlignment="Right" HorizontalContentAlignment="Left" Margin="0,-3,10,0" FontWeight="Bold"/>
                                <Image x:Name="UiGamesImgRightArrowChapter" Grid.Column="2" Cursor="Hand"  HorizontalAlignment="Right" Margin="0,0,10,0" Source="Resources/Images/RightArrowChapters.png" PreviewMouseLeftButtonDown="UiImgChapterRightArrow_PreviewMouseLeftButtonDown"  />
                            </Grid>
                            <RichTextBox x:Name="UiRtbModelGamesView"  ContextMenu="{x:Null}" IsUndoEnabled="False" Grid.Row="1" HorizontalAlignment="Left" Margin="2,2,2,2" VerticalAlignment="Top" Grid.ColumnSpan="3" FontSize="14"
                                 SelectionOpacity="0" Cursor="Arrow" Background="White" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                                   Height="600" MinHeight="500" IsReadOnly="True" >
                                <RichTextBox.Resources>
                                    <Style TargetType="{x:Type Paragraph}">
                                        <Setter Property="Margin" Value="0" />
                                    </Style>
                                </RichTextBox.Resources>
                                <FlowDocument>
                                </FlowDocument>
                            </RichTextBox>
                            <StackPanel Orientation="Horizontal" Grid.Row="1" Grid.ColumnSpan="3" HorizontalAlignment="Center" Height="48" Margin="0,588,0,0" VerticalAlignment="Top">
                                <Button x:Name="UiBtnGmPencil" Background="Transparent" Margin="0,0,0,0" Width="30" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnPencil_Click"  />
                                <Button x:Name="UiBtnGmCommentBeforeMove" Background="Transparent" Margin="0,0,0,0" Width="30" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnCommentBeforeMove_Click"  />
                                <Button x:Name="UiBtnGmEvalWin" Background="Transparent" Margin="30,0,0,0" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalWin_Click" />
                                <Button x:Name="UiBtnGmEvalPlusMinus" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalPlusMinus_Click" />
                                <Button x:Name="UiBtnGmEvalPlusEqual" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalPlusEqual_Click" />
                                <Button x:Name="UiBtnGmEvalEqual" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalEqual_Click" />
                                <Button x:Name="UiBtnGmEvalUnclear" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalUnclear_Click" />
                                <Button x:Name="UiBtnGmEvalEqualPlus" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalEqualPlus_Click" />
                                <Button x:Name="UiBtnGmEvalMinusPlus" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalMinusPlus_Click" />
                                <Button x:Name="UiBtnGmEvalLoss" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalLoss_Click" />
                                <Button x:Name="UiBtnGmEvalExclamExclam" Background="Transparent" Margin="30,0,0,0" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalExclamExclam_Click" />
                                <Button x:Name="UiBtnGmEvalExclam" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalExclam_Click" />
                                <Button x:Name="UiBtnGmEvalExclamQuest" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalExclamQuest_Click" />
                                <Button x:Name="UiBtnGmEvalQuestExclam" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalQuestExclam_Click" />
                                <Button x:Name="UiBtnGmEvalQuest" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalQuest_Click" />
                                <Button x:Name="UiBtnGmEvalQuestQuest" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalQuestQuest_Click" />
                            </StackPanel>
                        </Grid>
                    </TabItem>
                    <TabItem x:Name="UiTabExercises"  Header="{x:Static p:Resources.Exercises}"  ContextMenu="{x:Null}" GotFocus="UiTabExercises_GotFocus" PreviewKeyDown="UiTabExercises_PreviewKeyDown" LostFocus="UiTabExercises_LostFocus" >
                        <Grid x:Name="UiGridExercises" Background="#FFE5E5E5"  PreviewMouseDown="VariationTreeView_OnPreviewMouseDown" ContextMenuOpening="SupressContextMenu"
                              PreviewKeyDown="ChessForgeMain_PreviewKeyDown" PreviewKeyUp="ChessForgeMain_PreviewKeyUp">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="20"/>
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.ContextMenu>
                                <ContextMenu x:Name="UiMncExercises">
                                    <MenuItem x:Name="UiMnExercisesExercise" Header="{x:Static p:Resources.Exercise}">
                                        <MenuItem x:Name="UiMnExercCreateExercise" Header="{x:Static p:Resources.CreateNewExercise}" Click="UiMnExerc_CreateExercise_Click" />
                                        <MenuItem x:Name="UiMnExercEditHeader" Header="{x:Static p:Resources.EditExerciseHeader}" Click="UiMnExerc_EditHeader_Click" />
                                        <MenuItem x:Name="UiMnExercEditPosition" Header="{x:Static p:Resources.EditStartingPosition}" Click="UiMnExerc_EditPosition_Click" />
                                        <MenuItem x:Name="UiMnMoveExerciseToChapter" Header="{x:Static p:Resources.MoveExerciseToChapter}"  Click="UiMnMoveExerciseToChapter_Click" />
                                        <MenuItem x:Name="UiMnExercExitSolving" Header="{x:Static p:Resources.ExitSolvingMode}" Click="UiMnExercExitSolving_Click" />
                                        <Separator x:Name="UiMnExerc_Separator_1"/>
                                        <MenuItem x:Name="UiMnExercDeleteThisExercise" Header="{x:Static p:Resources.DeleteThisExercise}" Click="UiMnExerc_DeleteExercise_Click" />
                                        <Separator x:Name="UiMnExerc_Separator_6"/>
                                        <MenuItem x:Name="UiMnExerc_ImportExercises" Header="{x:Static p:Resources.ImportExercises}" Click="UiMnImportExercises_Click"  />
                                    </MenuItem>
                                    <Separator />
                                    <MenuItem x:Name="UiMnExerc_ShowAllSolutions" Header="{x:Static p:Resources.ShowSolutionsInChapter}" IsCheckable="True" IsChecked="False"  Click="UiMnExerc_ShowSolutions_Click" />
                                    <MenuItem x:Name="UiMnExerc_HideAllSolutions" Header="{x:Static p:Resources.HideSolutionsInChapter}" Click="UiMnExerc_HideSolutions_Click" />
                                    <Separator x:Name="UiMnExerc_Separator_8"/>
                                    <MenuItem x:Name="UiMnExercStartTrainingFromHere"  Header="{x:Static p:Resources.StartTrainingFromHere}" Click="UiMnStartTrainingHere_Click" InputGestureText="T" />
                                    <MenuItem x:Name="_mnExerc_MarkThumbnail" Header="{x:Static p:Resources.MarkAsThumbnail}" Click="UiMn_ExerciseMarkThumbnail_Click" InputGestureText="Ctrl+T" />
                                    <MenuItem x:Name="UiMnExercMarkBookmark" Header="{x:Static p:Resources.BookmarkThisPosition}" Click="UiMnMarkBookmark_Click" />
                                    <MenuItem x:Name="UiMnExercDeleteBookmark" Visibility="Collapsed" Header="{x:Static p:Resources.DeleteThisBookmark}" Click="UiMnciDeleteBookmark_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnExercInsertDiagramPreComment" Header="{x:Static p:Resources.InsertDiagramPreComment}" Click="UiMn_InsertPreCommentDiagram_Click" InputGestureText="Ctrl+I" />
                                    <MenuItem x:Name="UiMnExercInsertDiagramPostComment" Header="{x:Static p:Resources.InsertDiagramPostComment}" Click="UiMn_InsertPostCommentDiagram_Click" InputGestureText="Ctrl+J" />
                                    <MenuItem x:Name="UiMnExerc_DeleteDiagram" Visibility="Collapsed" Header="{x:Static p:Resources.RemoveDiagram}" Click="UiMn_DeleteDiagram_Click" InputGestureText="Ctrl+I" />
                                    <MenuItem x:Name="UiMnExercSwapDiagramComment" Visibility="Collapsed" Header="{x:Static p:Resources.SwapDiagramComment}" Click="UiMn_SwapDiagramComment_Click" />
                                    <MenuItem x:Name="UiMnExercInvertDiagram" Header="{x:Static p:Resources.InvertDiagram}"  Click="UiMn_InvertDiagram_Click" />
                                    <MenuItem x:Name="UiMnExercSaveDiagram" Header="{x:Static p:Resources.SaveDiagramAsImage}"  Click="UiMn_SaveDiagram_Click" />
                                    <Separator x:Name="UiMnExerc_Separator_4"/>
                                    <MenuItem x:Name="UiMnExercPromoteLine" Header="{x:Static p:Resources.PromoteLine}" Click="UiMnExerc_PromoteLine_Click" InputGestureText="P"  />
                                    <MenuItem x:Name="UiMnExercReorderLines" Header="{x:Static p:Resources.ReorderLines}" Click="UiMnReorderLines_Click" />
                                    <MenuItem x:Name="UiMnExercEnterNullMove" Header="{x:Static p:Resources.EnterNullMove}" Click="UiMnEnterNullMove_Click" />
                                    <MenuItem x:Name="UiMnExercDuplicateAsVariation" Header="{x:Static p:Resources.DuplicateAsVariation}" Click="UiMnDuplicateAsVariation_Click" />
                                    <Separator />
                                    <MenuItem x:Name="UiMnExercDeleteMovesFromHere" Header="{x:Static p:Resources.DeleteMovesFromHere}" Click="UiMnExerc_DeleteMovesFromHere_Click" InputGestureText="Del" />
                                    <Separator x:Name="UiMnExerc_Separator_2"/>
                                    <MenuItem x:Name="UiMnExerc_EvalMove" Header="{x:Static p:Resources.EvaluatePosition}"  Click="UiMnEvaluatePosition_Click" />
                                    <MenuItem x:Name="UiMnExercDontSaveEvals" Header="{x:Static p:Resources.DoNotUpdatePositionEval}" IsCheckable="True" Click="UiMnDontSaveEvals_Click" InputGestureText="Ctrl+K" />
                                    <Separator x:Name="UiMnExercSepar_EvalPos" />
                                    <MenuItem x:Name="UiMnExerc_EvalLine" Header="{x:Static p:Resources.EvaluateLine}"  Click="UiMnEvaluateLine_Click" />
                                    <Separator x:Name="UiMnExercSepar_EvalLine" />
                                    <MenuItem x:Name="UiMnExercFindIdentical" Header="{x:Static p:Resources.FindIdenticalPosition}" Click="UiMnFindIdenticalPosition_Click" InputGestureText="F3" />
                                    <MenuItem x:Name="UiMnExercFindPositions" Header="{x:Static p:Resources.SearchByFen}"  Click="UiMnFindPositions_Click" InputGestureText="Shift+F3" />
                                </ContextMenu>
                            </Grid.ContextMenu>
                            <Grid x:Name="UiGridExercisePrevNext" Grid.Row="0" Panel.ZIndex="1" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Visible" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto "/>
                                </Grid.RowDefinitions>
                                <Image x:Name="UiImgExerciseLeftArrow" Grid.Column="0" Cursor="Hand"  HorizontalAlignment="Left"  Margin="10,0,0,0" Source="Resources/Images/LeftArrow.png" PreviewMouseLeftButtonDown="UiImgExerciseLeftArrow_PreviewMouseLeftButtonDown"  />
                                <Label x:Name="UiLblExerciseCounter" Grid.Column="1" Content="" HorizontalAlignment="Left" HorizontalContentAlignment="Left" Margin="5,-3,0,0" FontWeight="Bold"/>
                                <Image x:Name="UiImgExerciseRightArrow" Grid.Column="2" Cursor="Hand"  HorizontalAlignment="Right" Margin="5,0,0,0" Source="Resources/Images/RightArrow.png" PreviewMouseLeftButtonDown="UiImgExerciseRightArrow_PreviewMouseLeftButtonDown"  />
                            </Grid>
                            <Label x:Name="UiExerciseLblChapterTitle" Grid.Column="0" Height="30" Content="" MaxWidth="220" HorizontalAlignment="Center" HorizontalContentAlignment="Center" Margin="0,-3,10,0" FontWeight="Normal" FontStyle="Normal" MouseDoubleClick="UiExerciseLblChapterTitle_MouseDoubleClick"  />
                            <Grid x:Name="UiGridExercisePrevNextChapter" Panel.ZIndex="1" Grid.Row="0" HorizontalAlignment="Right" VerticalAlignment="Top" Visibility="Visible" >
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                    <ColumnDefinition Width="Auto "/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto "/>
                                </Grid.RowDefinitions>
                                <Image x:Name="UiExerciseImgLeftArrowChapter" Grid.Column="0" Cursor="Hand"  HorizontalAlignment="Left"  Margin="0,0,10,0" Source="Resources/Images/LeftArrowChapters.png" PreviewMouseLeftButtonDown="UiImgChapterLeftArrow_PreviewMouseLeftButtonDown"  />
                                <Label x:Name="UiExerciseLblCounterChapter" Grid.Column="1" Content="" HorizontalAlignment="Right" HorizontalContentAlignment="Left" Margin="0,-3,10,0" FontWeight="Bold"/>
                                <Image x:Name="UiExerciseImgRightArrowChapter" Grid.Column="2" Cursor="Hand"  HorizontalAlignment="Right" Margin="0,0,10,0" Source="Resources/Images/RightArrowChapters.png" PreviewMouseLeftButtonDown="UiImgChapterRightArrow_PreviewMouseLeftButtonDown"  />
                            </Grid>
                            <RichTextBox x:Name="UiRtbExercisesView" IsUndoEnabled="False" Grid.Row="1" HorizontalAlignment="Left" Margin="2,2,2,2" VerticalAlignment="Top" Grid.ColumnSpan="3" FontSize="14"
                                 SelectionOpacity="0" Cursor="Arrow" Background="White" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                                   Height="600" MinHeight="500" IsReadOnly="True"  BorderThickness="0">
                                <RichTextBox.Resources>
                                    <Style TargetType="{x:Type Paragraph}">
                                        <Setter Property="Margin" Value="0" />
                                    </Style>
                                </RichTextBox.Resources>
                                <FlowDocument>
                                </FlowDocument>
                            </RichTextBox>
                            <StackPanel x:Name="UiStpExNags" Orientation="Horizontal" Grid.Row="1" Grid.ColumnSpan="3" HorizontalAlignment="Center" Height="48" Margin="0,588,0,0" VerticalAlignment="Top">
                                <Button x:Name="UiBtnExPencil" Background="Transparent" Margin="0,0,0,0" Width="30" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnPencil_Click"  />
                                <Button x:Name="UiBtnExCommentBeforeMove" Background="Transparent" Margin="0,0,0,0" Width="30" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnCommentBeforeMove_Click"  />
                                <Button x:Name="UiBtnExEvalWin" Background="Transparent" Margin="30,0,0,0" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalWin_Click" />
                                <Button x:Name="UiBtnExEvalPlusMinus" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalPlusMinus_Click" />
                                <Button x:Name="UiBtnExEvalPlusEqual" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalPlusEqual_Click" />
                                <Button x:Name="UiBtnExEvalEqual" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalEqual_Click" />
                                <Button x:Name="UiBtnExEvalUnclear" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalUnclear_Click" />
                                <Button x:Name="UiBtnExEvalEqualPlus" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalEqualPlus_Click" />
                                <Button x:Name="UiBtnExEvalMinusPlus" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalMinusPlus_Click" />
                                <Button x:Name="UiBtnExEvalLoss" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalLoss_Click" />
                                <Button x:Name="UiBtnExEvalExclamExclam" Background="Transparent" Margin="30,0,0,0" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalExclamExclam_Click" />
                                <Button x:Name="UiBtnExEvalExclam" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalExclam_Click" />
                                <Button x:Name="UiBtnExEvalExclamQuest" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalExclamQuest_Click" />
                                <Button x:Name="UiBtnExEvalQuestExclam" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalQuestExclam_Click" />
                                <Button x:Name="UiBtnExEvalQuest" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalQuest_Click" />
                                <Button x:Name="UiBtnExEvalQuestQuest" Background="Transparent" Width="18" Height="18" BorderThickness="0" FontSize="12" Content="" VerticalContentAlignment="Center" Padding="0" Click="UiBtnEvalQuestQuest_Click" />
                            </StackPanel>
                        </Grid>
                    </TabItem>
                    <TabItem x:Name="UiTabBookmarks" Header="{x:Static p:Resources.Bookmarks}"  ContextMenu="{x:Null}" GotFocus="UiTabBookmarks_GotFocus" >
                        <Grid Background="#FFE5E5E5" PreviewMouseDown="Bookmarks_PreviewMouseDown" ContextMenuOpening="UiBookmarkMenuOpening">
                            <Grid.ContextMenu>
                                <ContextMenu x:Name="UiMncBookmarks">
                                    <MenuItem x:Name="_mnDeleteBookmark" Header="{x:Static p:Resources.DeleteThisBookmark}" Click="UiMnDeleteBookmark_Click" />
                                    <MenuItem x:Name="_mnDeleteAllBookmarks" Header="{x:Static p:Resources.DeleteAllBookmarks}" Click="UiMnDeleteAllBookmarks_Click" />
                                    <Separator />
                                    <MenuItem x:Name="_mnTrainFromBookmark" Header="{x:Static p:Resources.StartTrainingFromThisBookmark}" Click="UiMnTrainFromBookmark_Click" />
                                    <MenuItem x:Name="UiMnBmGotoPosition" Header="{x:Static p:Resources.GoToPosition}" Click="UiMnBmGotoPosition_Click" />
                                </ContextMenu>
                            </Grid.ContextMenu>
                            <Grid x:Name="UiGridBookmarks" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,0,0,0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="15"/>
                                    <RowDefinition Height="270*"/>
                                    <RowDefinition Height="270*"/>
                                    <RowDefinition Height="270*"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="220*"/>
                                    <ColumnDefinition Width="220*"/>
                                    <ColumnDefinition Width="220*"/>
                                    <ColumnDefinition Width="220*"/>
                                </Grid.ColumnDefinitions>

                                <Canvas x:Name="UiCnvPaging" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4" HorizontalAlignment="Left" Visibility="Visible" >
                                    <Grid HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,0,0,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="250"/>
                                            <ColumnDefinition Width="85"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="320*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid Grid.Column="0" >
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Label x:Name="UiLblBmChapters" Grid.Column="0" Content="{x:Static p:Resources.Chapter}" Margin="20,0,0,0" FontSize="12"  />
                                            <ComboBox x:Name="UiComboBoxBmChapters" Grid.Column="1" Margin="0,2,0,0"  Width="30" Height="18" FontSize="12" SelectionChanged="UiComboBoxBmChapters_SelectionChanged" />
                                            <Label x:Name="UiLblBmCContent" Content="{x:Static p:Resources.Content}" Margin="25,0,0,0" Grid.Column="2" FontSize="12" />
                                            <ComboBox x:Name="UiComboBoxBmContent" Grid.Column="3" Margin="0,2,0,0" Width="65" Height="18" FontSize="12" SelectionChanged="UiComboBoxBmContent_SelectionChanged" />
                                        </Grid>
                                        <Image x:Name="UiImgLeftArrow" Cursor="Hand" Grid.Column="1" HorizontalAlignment="Right"  Margin="0,9,0,0" Source="Resources/Images/LeftArrow.png" PreviewMouseDown="Bookmarks_PreviousPage_OnPreviewMouseDown"  />
                                        <Label x:Name="UiLblBookmarkPage" Content="" Padding="15,9,15,0" Grid.Column="2" HorizontalAlignment="Center" HorizontalContentAlignment="Center" Margin="0,0,0,0" FontWeight="Bold" />
                                        <Image x:Name="UiImgRightArrow" Cursor="Hand" Grid.Column="3" HorizontalAlignment="Left" Margin="0,9,0,0" Source="Resources/Images/RightArrow.png" PreviewMouseDown="Bookmarks_NextPage_OnPreviewMouseDown"  />
                                    </Grid>
                                </Canvas>

                                <Viewbox x:Name="_vbLblChapter_1" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_1" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_1" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_1" FontSize="10"  Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_1" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Center" Margin="10,50,10,10" VerticalAlignment="Top" >
                                    <Canvas x:Name="UiCnvBookmark_1" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_1" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_2" Grid.Row="1" Grid.Column="1" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_2" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_2" Grid.Row="1" Grid.Column="1" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_2" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_2" Grid.Row="1" Grid.Column="1" HorizontalAlignment="Center" Margin="10,50,10,10" VerticalAlignment="Top" >
                                    <Canvas x:Name="UiCnvBookmark_2" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_2" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_3" Grid.Row="1" Grid.Column="2" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_3" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_3" Grid.Row="1" Grid.Column="2" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_3" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_3" Grid.Row="1" Grid.Column="2" HorizontalAlignment="Center" Margin="10,50,10,10" VerticalAlignment="Top">
                                    <Canvas x:Name="UiCnvBookmark_3" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_3" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_4" Grid.Row="1" Grid.Column="3" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_4" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_4" Grid.Row="1" Grid.Column="3" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_4" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_4" Grid.Row="1" Grid.Column="3" HorizontalAlignment="Center" Margin="10,50,10,10" VerticalAlignment="Top">
                                    <Canvas x:Name="UiCnvBookmark_4" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_4" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_5" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_5" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_5" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_5" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_5" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Center" Margin="10,50,10,10" VerticalAlignment="Top">
                                    <Canvas x:Name="UiCnvBookmark_5" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_5" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_6" Grid.Row="2" Grid.Column="1" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_6" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_6" Grid.Row="2" Grid.Column="1" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_6" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_6" Grid.Row="2" Grid.Column="1" HorizontalAlignment="Center" Margin="10,50,10,10" VerticalAlignment="Top" >
                                    <Canvas x:Name="UiCnvBookmark_6" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_6" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_7" Grid.Row="2" Grid.Column="2" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_7" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_7" Grid.Row="2" Grid.Column="2" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_7" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_7" Grid.Row="2" Grid.Column="2" HorizontalAlignment="Center" Margin="10,50,10,10" VerticalAlignment="Top" >
                                    <Canvas x:Name="UiCnvBookmark_7" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_7" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_8" Grid.Row="2" Grid.Column="3" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_8" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_8" Grid.Row="2" Grid.Column="3" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_8" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_8" Grid.Row="2" Grid.Column="3" HorizontalAlignment="Center" Margin="10,50,10,10" VerticalAlignment="Top" >
                                    <Canvas x:Name="UiCnvBookmark_8" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_8" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_9" Grid.Row="3" Grid.Column="0" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_9" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_9" Grid.Row="3" Grid.Column="0" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_9" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_9" Grid.Row="3" Grid.Column="0" HorizontalAlignment="Center"  Margin="10,50,10,10" VerticalAlignment="Top" >
                                    <Canvas x:Name="UiCnvBookmark_9" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_9" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_10" Grid.Row="3" Grid.Column="1" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_10" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_10" Grid.Row="3" Grid.Column="1" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_10" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_10" Grid.Row="3" Grid.Column="1" HorizontalAlignment="Center" Margin="10,50,10,10" VerticalAlignment="Top" >
                                    <Canvas x:Name="UiCnvBookmark_10" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_10" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_11" Grid.Row="3" Grid.Column="2" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_11" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_11" Grid.Row="3" Grid.Column="2" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_11" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_11" Grid.Row="3" Grid.Column="2" HorizontalAlignment="Center"  Margin="10,50,10,10" VerticalAlignment="Top" >
                                    <Canvas x:Name="UiCnvBookmark_11" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_11" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                                <Viewbox x:Name="_vbLblChapter_12" Grid.Row="3" Grid.Column="3" HorizontalAlignment="Center" Height="25" Margin="0,15,0,0" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblChapter_12" FontSize="10" Content="{x:Static p:Resources.Chapter}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="180" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbLblBookmark_12" Grid.Row="3" Grid.Column="3" HorizontalAlignment="Center" Height="25" Margin="0,28,0,10" VerticalAlignment="Top" >
                                    <Label x:Name="UiLblBookmark_12" FontSize="10" Content="{x:Static p:Resources.Bookmark}" VerticalContentAlignment="Bottom" HorizontalContentAlignment="Center"  HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Width="200" FontWeight="Bold"/>
                                </Viewbox>
                                <Viewbox x:Name="_vbBookmark_12" Grid.Row="3" Grid.Column="3" HorizontalAlignment="Center"  Margin="10,50,10,10" VerticalAlignment="Top" >
                                    <Canvas x:Name="UiCnvBookmark_12" Grid.Column="0" HorizontalAlignment="Left" Height="244" Margin="0,0,0,0" VerticalAlignment="Top" Width="244" PreviewMouseDown="Bookmarks_Chessboards_OnPreviewMouseDown">
                                        <Canvas.Background>
                                            <SolidColorBrush Color="{DynamicResource MainBoardBackGround}"/>
                                        </Canvas.Background>
                                        <Image x:Name="UiImgBookmark_12" Margin="2,2,2,2" Source="Resources/Images/ChessBoardGreySmall.png" HorizontalAlignment="Left" VerticalAlignment="Top" Width="240" Height="240" Grid.Column="0" />
                                    </Canvas>
                                </Viewbox>

                            </Grid>
                        </Grid>
                    </TabItem>
                </TabControl>
                <Label x:Name="UiLblScoresheet" FontWeight="Bold" Content="{x:Static p:Resources.Scoresheet}"  Grid.Column="1" Grid.ColumnSpan="2"  HorizontalAlignment="Right" VerticalContentAlignment="Center" Height="24" Margin="0,0,68,0" Width="80" VerticalAlignment="Top" Visibility="Visible" Grid.Row="1" />
                <DataGrid x:Name="UiDgActiveLine" Grid.Column="1" Grid.ColumnSpan="2" HorizontalAlignment="Right" Height="648" Margin="0,27,10,0" VerticalAlignment="Top" Width="260"  
                  SelectionMode="Single" SelectionUnit="Cell" AutoGenerateColumns="False" ItemsSource="{Binding}" IsReadOnly="True" 
                  VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Hidden"
                  CanUserSortColumns="False" GridLinesVisibility="None" Grid.Row="1" 
                  MouseDoubleClick="ActiveLine_OnMouseDoubleClick" PreviewMouseDown="ActiveLine_OnPreviewMouseDown" 
                  PreviewKeyDown="ViewActiveLine_PreviewKeyDown" PreviewMouseUp="ActiveLine_OnPreviewMouseUp"  >
                    <DataGrid.Resources>
                        <Style x:Key="DisableSelection" TargetType="{x:Type DataGridCell}">
                            <Setter Property="Focusable" Value="False"/>
                        </Style>
                        <Style TargetType="{x:Type DataGridCell}">
                            <Setter Property="BorderThickness" Value="0" />
                        </Style>
                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" 
                   Color= "{DynamicResource {x:Static SystemColors.HighlightColorKey}}" />
                        <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" 
                   Color= "{DynamicResource {x:Static SystemColors.HighlightTextColorKey}}" />
                    </DataGrid.Resources>
                    <DataGrid.RowStyle>
                        <Style TargetType="{x:Type DataGridRow}"/>
                    </DataGrid.RowStyle>
                    <DataGrid.Background>
                        <SolidColorBrush Color="White"/>
                    </DataGrid.Background>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="#" Width="30" Binding="{Binding Number}" CellStyle="{StaticResource DisableSelection}" CanUserReorder="False" />
                        <DataGridTextColumn Header="{x:Static p:Resources.White}" Width="60" Binding="{Binding WhitePly}" CanUserReorder="False" />
                        <DataGridTextColumn Header="{x:Static p:Resources.EvaluationShort}" Width="50" Binding="{Binding WhiteEval}"  CellStyle="{StaticResource DisableSelection}" CanUserReorder="False"/>
                        <DataGridTextColumn Header="{x:Static p:Resources.Black}" Width="60" Binding="{Binding BlackPly}" CanUserReorder="False"/>
                        <DataGridTextColumn Header="{x:Static p:Resources.EvaluationShort}" Width="50" Binding="{Binding BlackEval}"  CellStyle="{StaticResource DisableSelection}" CanUserReorder="False"/>
                    </DataGrid.Columns>
                </DataGrid>
                <uc:EvaluationChartControl x:Name="UiEvalChart" Panel.ZIndex="1"  FontSize="12"
                                           Grid.Row="2" HorizontalAlignment="Left" VerticalAlignment="Top"
                                           Width="672" Height="150" Margin="4,10,0,0" 
                                           BorderThickness="1" BorderBrush="Black"
                                           Visibility="Hidden">
                </uc:EvaluationChartControl>
                <TextBox x:Name="UiTbEngineLines" TextWrapping="NoWrap" Text="" 
                         Width="672" Height="150" Margin="0,10,0,0" 
                         Grid.Row="2" VerticalAlignment="Top" 
                         BorderThickness="1" Background="#FFF2F5F3" BorderBrush="Black" Visibility="Hidden" VerticalScrollBarVisibility="Auto" 
                         PreviewMouseRightButtonUp="UiTbEngineLines_MouseRightButtonUp" PreviewMouseDoubleClick="UiTbEngineLines_PreviewMouseDoubleClick" />
                <RichTextBox x:Name="UiRtbBoardComment"  ContextMenu="{x:Null}" IsUndoEnabled="False" Panel.ZIndex="0" 
                             Grid.Row="2" HorizontalAlignment="Left" VerticalAlignment="Top" 
                             Width="672" Height="150" Margin="4,10,0,0"
                             BorderThickness="1" BorderBrush="Black" IsReadOnly="True">
                    <RichTextBox.Resources>
                        <Style TargetType="{x:Type Paragraph}">
                            <Setter Property="Margin" Value="0" />
                        </Style>
                    </RichTextBox.Resources>
                    <FlowDocument PageWidth="670">
                        <Paragraph FontSize="20" FontWeight="Bold" TextAlignment="Center" Margin="0,0,0,0"></Paragraph>
                        <Paragraph FontSize="20" FontWeight="Bold" TextAlignment="Center" Margin="0,0,0,0">
                            <Run>Welcome to</Run>
                        </Paragraph>
                        <Paragraph FontSize="36" FontWeight="Bold" TextAlignment="Center">
                            <Image Source="Resources/Images/icon_blue.ico" Margin="0,0,100,0" Height="48" Width="48"></Image>
                            <Run>Chess Forge</Run>
                            <Image Source="Resources/Images/icon_green.ico" Margin="100,0,0,0" Height="48" Width="48"></Image>
                        </Paragraph>
                    </FlowDocument>
                </RichTextBox>
                <RichTextBox x:Name="UiRtbOpenings" IsUndoEnabled="False"  ContextMenu="{x:Null}" 
                             Panel.ZIndex="0" HorizontalAlignment="Left" 
                             Height="150" Width="590" Margin="5,10,0,0"
                             Grid.Column="1" Grid.Row="2" Grid.ColumnSpan="2" 
                             VerticalScrollBarVisibility="Auto"
                             VerticalAlignment="Top" BorderThickness="1" IsReadOnly="True">
                    <RichTextBox.Resources>
                        <Style TargetType="{x:Type Paragraph}">
                            <Setter Property="Margin" Value="0" />
                        </Style>
                    </RichTextBox.Resources>
                </RichTextBox>
                <uc:TrainingSessionControl x:Name="UiTrainingSessionBox" FontSize="12"
                                           Panel.ZIndex="0" HorizontalAlignment="Left" 
                                           Height="150" Width="669" Margin="5,10,0,0" 
                                           Grid.Column="1" Grid.Row="2" Grid.ColumnSpan="2" 
                                           VerticalAlignment="Top" BorderThickness="1" BorderBrush="Black"
                                           Visibility="Hidden">
                </uc:TrainingSessionControl>
                <RichTextBox x:Name="UiRtbTopGames" IsUndoEnabled="False" Panel.ZIndex="0" HorizontalAlignment="Left" Height="150" Margin="600,10,0,0" Grid.Row="2" VerticalScrollBarVisibility="Auto"
                             Grid.Column="1" Grid.ColumnSpan="2" VerticalAlignment="Top" Width="260" BorderThickness="1" IsReadOnly="True">
                    <RichTextBox.Resources>
                        <Style TargetType="{x:Type Paragraph}">
                            <Setter Property="Margin" Value="0" />
                        </Style>
                    </RichTextBox.Resources>
                    <RichTextBox.ContextMenu>
                        <ContextMenu x:Name="UiMncTopGames">
                            <MenuItem x:Name="UiMnTopGamePreview" Header="{x:Static p:Resources.PreviewGame}" Click="UiMnTopGamePreview_Click" />
                            <MenuItem x:Name="UiMnTopGameImport" Header="{x:Static p:Resources.ImportIntoThisChapter}" Click="UiMnTopGameImport_Click" />
                            <MenuItem x:Name="UiMnTopGameLichessView" Header="{x:Static p:Resources.ViewOnLichess}" Click="UiMnTopGameLichessView_Click" />
                        </ContextMenu>
                    </RichTextBox.ContextMenu>
                </RichTextBox>
                <Button x:Name="UiBtnExitTraining" Panel.ZIndex="1" Grid.Column="1" Content="{x:Static p:Resources.ExitTraining}" FontWeight="Bold" FontSize="18" HorizontalAlignment="Left" Margin="70,50,0,0" Width="160" Height="40" Grid.Row="2" VerticalAlignment="Top" Click="UiBtnExitTraining_Click" Visibility="Collapsed" />
                <Button x:Name="UiBtnExitGame" Panel.ZIndex="1" Grid.Column="1" Content="{x:Static p:Resources.ExitGame}" FontWeight="Bold" FontSize="18" HorizontalAlignment="Left" Margin="70,50,20,0" Width="160" Height="40" Grid.Row="2" VerticalAlignment="Top" Click="UiBtnExitGame_Click" Visibility="Collapsed" />
                <Button x:Name="UiBtnShowExplorer" Panel.ZIndex="0" Grid.Column="1" Grid.ColumnSpan="2" Content="{x:Static p:Resources.ShowExplorer}" FontWeight="Bold" FontSize="12" HorizontalAlignment="Left" Margin="235,50,20,0" Width="100" Height="24" Grid.Row="2" VerticalAlignment="Top" Click="UiBtnShowExplorer_Click" Visibility="Collapsed" />

            </Grid>
        </Viewbox>
    </Grid>
</Window>
